SSPI System using System.Net using class SSPI.SSPIHelper string decl WindowsAPI decl SECURITY_HANDLE NetworkCredential string bool decl SecBufferDesc decl AuthIdentityEx decl WindowsAPI decl WindowsAPI decl WindowsAPI int var decl SECURITY_INTEGER public public out out out out = = decl_stmt SECURITY_INTEGER = new decl_stmt int = - if ! if == = ref ref else decl_stmt AuthIdentityEx = new if == = ref ref ref else = ref ref ref if != throw = decl_stmt SecBufferDesc = new try decl_stmt var = | | | decl_stmt uint = decl_stmt SECURITY_HANDLE if == = ref out out out out else decl_stmt SecBufferDesc = new try = ref ref ref out out out out finally call var.Dispose() call var.Dispose() call var.Dispose() call var.Dispose() call var.Dispose() = if != && != throw = call decl WindowsAPI.GetSecBufferByteArray() call decl WindowsAPI.GetSecBufferByteArray() call decl WindowsAPI.GetSecBufferByteArray() call decl WindowsAPI.GetSecBufferByteArray() call decl WindowsAPI.GetSecBufferByteArray() finally call decl WindowsAPI.Dispose() call decl WindowsAPI.Dispose() call decl WindowsAPI.Dispose() call decl WindowsAPI.Dispose() call decl WindowsAPI.Dispose() = != decl WindowsAPI decl WindowsAPI decl SECURITY_HANDLE decl SecPkgContext_Sizes var public public out out = decl_stmt SECURITY_HANDLE = decl_stmt SecPkgContext_Sizes = new decl_stmt var = ref out if != throw decl_stmt MultipleSecBufferHelper = new = new = new = new decl_stmt SecBufferDesc = new try decl_stmt var = ref ref if != throw = call var.GetSecBufferByteArray() call var.GetSecBufferByteArray() call var.GetSecBufferByteArray() call var.GetSecBufferByteArray() call var.GetSecBufferByteArray() finally call var.Dispose() call var.Dispose() call var.Dispose() call var.Dispose() call var.Dispose() decl WindowsAPI decl SECURITY_HANDLE decl byte decl WindowsAPI decl WindowsAPI decl MultipleSecBufferHelper public public out out = decl_stmt SECURITY_HANDLE = decl_stmt byte = new decl_stmt MultipleSecBufferHelper = new = new = new decl_stmt SecBufferDesc = new try decl_stmt uint = decl_stmt var = ref ref out if != throw = new call decl WindowsAPI.GetSecBufferByteArray() call decl WindowsAPI.GetSecBufferByteArray() call decl WindowsAPI.GetSecBufferByteArray() call decl WindowsAPI.GetSecBufferByteArray() call decl WindowsAPI.GetSecBufferByteArray() finally call decl WindowsAPI.Dispose() call decl WindowsAPI.Dispose() call decl WindowsAPI.Dispose() call decl WindowsAPI.Dispose() call decl WindowsAPI.Dispose()