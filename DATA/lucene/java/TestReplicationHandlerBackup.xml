org.apache.solr.handler java.io.File import java.io.IOException import java.io.InputStream import java.net.URL import java.nio.file.DirectoryStream import java.nio.file.Files import java.nio.file.Path import java.nio.file.Paths import java.util.Iterator import java.util.Properties import java.util.regex.Matcher import java.util.regex.Pattern import org.apache.commons.io.IOUtils import org.apache.lucene.index.DirectoryReader import org.apache.lucene.index.IndexReader import org.apache.lucene.search.IndexSearcher import org.apache.lucene.search.MatchAllDocsQuery import org.apache.lucene.search.TopDocs import org.apache.lucene.store.Directory import org.apache.lucene.store.SimpleFSDirectory import org.apache.lucene.util.TestUtil import org.apache.solr.SolrJettyTestBase import org.apache.solr.SolrTestCaseJ4 import org.apache.solr.client.solrj.SolrClient import org.apache.solr.client.solrj.SolrServerException import org.apache.solr.client.solrj.embedded.JettyConfig import org.apache.solr.client.solrj.embedded.JettySolrRunner import org.apache.solr.client.solrj.impl.HttpSolrClient import org.apache.solr.common.SolrInputDocument import org.apache.solr.util.FileUtils import org.junit.After import org.junit.Before import org.junit.Test import class annotation comment org.apache.solr.handler.TestReplicationHandlerBackup super super extends SolrClient decl SolrInstance boolean JettySolrRunner String decl TestReplicationHandler String JettyConfig Properties JettySolrRunner private static private static throws new new decl_stmt java.util.Properties = new call Properties.setProperty() call Properties.setProperty() call Properties.setProperty() call Properties.setProperty() call Properties.setProperty() decl_stmt org.apache.solr.client.solrj.embedded.JettyConfig = decl_stmt org.apache.solr.client.solrj.embedded.JettySolrRunner = new call org.apache.solr.client.solrj.embedded.JettySolrRunner.start() call org.apache.solr.client.solrj.embedded.JettySolrRunner.start() call org.apache.solr.client.solrj.embedded.JettySolrRunner.start() call org.apache.solr.client.solrj.embedded.JettySolrRunner.start() call org.apache.solr.client.solrj.embedded.JettySolrRunner.start() return HttpSolrClient String private static private static try decl_stmt java.lang.String final final = + + decl_stmt org.apache.solr.client.solrj.impl.HttpSolrClient = call org.apache.solr.client.solrj.impl.HttpSolrClient.setConnectionTimeout(int) call org.apache.solr.client.solrj.impl.HttpSolrClient.setConnectionTimeout(int) call org.apache.solr.client.solrj.impl.HttpSolrClient.setConnectionTimeout(int) call org.apache.solr.client.solrj.impl.HttpSolrClient.setConnectionTimeout(int) call org.apache.solr.client.solrj.impl.HttpSolrClient.setConnectionTimeout(int) call org.apache.solr.client.solrj.impl.HttpSolrClient.setSoTimeout(int) call org.apache.solr.client.solrj.impl.HttpSolrClient.setSoTimeout(int) call org.apache.solr.client.solrj.impl.HttpSolrClient.setSoTimeout(int) call org.apache.solr.client.solrj.impl.HttpSolrClient.setSoTimeout(int) call org.apache.solr.client.solrj.impl.HttpSolrClient.setSoTimeout(int) return catch throw new String public public throws decl_stmt java.lang.String = if = = = = new call decl TestReplicationHandler.setUp() call decl TestReplicationHandler.setUp() call decl TestReplicationHandler.setUp() call decl TestReplicationHandler.setUp() call decl TestReplicationHandler.setUp() call decl TestReplicationHandler.copyConfigFile() call decl TestReplicationHandler.copyConfigFile() call decl TestReplicationHandler.copyConfigFile() call decl TestReplicationHandler.copyConfigFile() call decl TestReplicationHandler.copyConfigFile() + = = call JettySolrRunner.getLocalPort() call JettySolrRunner.getLocalPort() call JettySolrRunner.getLocalPort() call JettySolrRunner.getLocalPort() call JettySolrRunner.getLocalPort() public public throws call decl SolrInstance.close() call decl SolrInstance.close() call decl SolrInstance.close() call decl SolrInstance.close() call decl SolrInstance.close() = call org.apache.solr.client.solrj.embedded.JettySolrRunner.stop() call org.apache.solr.client.solrj.embedded.JettySolrRunner.stop() call org.apache.solr.client.solrj.embedded.JettySolrRunner.stop() call org.apache.solr.client.solrj.embedded.JettySolrRunner.stop() call org.apache.solr.client.solrj.embedded.JettySolrRunner.stop() = = CheckBackupStatus int Path public public throws decl_stmt int = decl_stmt org.apache.solr.handler.CheckBackupStatus = new while ! call CheckBackupStatus.fetchStatus() call CheckBackupStatus.fetchStatus() call CheckBackupStatus.fetchStatus() call CheckBackupStatus.fetchStatus() call CheckBackupStatus.fetchStatus() try < = call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() decl_stmt java.nio.file.Path = IndexSearcher TopDocs private private throws try = new = decl_stmt org.apache.lucene.search.IndexSearcher = new decl_stmt org.apache.lucene.search.TopDocs = call org.apache.lucene.search.IndexSearcher.search(Query,int) call org.apache.lucene.search.IndexSearcher.search(Query,int) call org.apache.lucene.search.IndexSearcher.search(Query,int) call org.apache.lucene.search.IndexSearcher.search(Query,int) call org.apache.lucene.search.IndexSearcher.search(Query,int) new SolrInputDocument int protected static protected static throws decl_stmt int = call decl SolrInstance.deleteByQuery() call decl SolrInstance.deleteByQuery() call decl SolrInstance.deleteByQuery() call decl SolrInstance.deleteByQuery() call decl SolrInstance.deleteByQuery() for = < ++ decl_stmt org.apache.solr.common.SolrInputDocument = new call org.apache.solr.common.SolrInputDocument.addField(String,Object) call org.apache.solr.common.SolrInputDocument.addField(String,Object) call org.apache.solr.common.SolrInputDocument.addField(String,Object) call org.apache.solr.common.SolrInputDocument.addField(String,Object) call org.apache.solr.common.SolrInputDocument.addField(String,Object) call org.apache.solr.common.SolrInputDocument.addField(String,Object) call org.apache.solr.common.SolrInputDocument.addField(String,Object) call org.apache.solr.common.SolrInputDocument.addField(String,Object) call org.apache.solr.common.SolrInputDocument.addField(String,Object) call org.apache.solr.common.SolrInputDocument.addField(String,Object) + call decl SolrInstance.add() call decl SolrInstance.add() call decl SolrInstance.add() call decl SolrInstance.add() call decl SolrInstance.add() call decl SolrInstance.commit() call decl SolrInstance.commit() call decl SolrInstance.commit() call decl SolrInstance.commit() call decl SolrInstance.commit() return int String String decl Iterator boolean int decl String CheckBackupStatus decl Path public public throws decl_stmt int = decl_stmt java.nio.file.Path = new try < = call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() = decl_stmt boolean = decl_stmt java.lang.String = decl_stmt java.lang.String = if = new for = < ++ decl_stmt java.lang.String final final = if ! if + + else else + = decl_stmt org.apache.solr.handler.CheckBackupStatus = new while ! call CheckBackupStatus.fetchStatus() call CheckBackupStatus.fetchStatus() call CheckBackupStatus.fetchStatus() call CheckBackupStatus.fetchStatus() call CheckBackupStatus.fetchStatus() if == = if ! try < = call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() + = else try < = call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() + + = + if else decl_stmt int = try < = call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() call decl TestReplicationHandler.getDataDir() decl_stmt java.util.Iterator < = while call decl Iterator.hasNext() call decl Iterator.hasNext() call decl Iterator.hasNext() call decl Iterator.hasNext() call decl Iterator.hasNext() call decl Iterator.next() call decl Iterator.next() call decl Iterator.next() call decl Iterator.next() call decl Iterator.next() ++ if call boolean.equals() call boolean.equals() call boolean.equals() call boolean.equals() call boolean.equals() if || || + + else if || || || + + boolean String CheckDeleteBackupStatus private private throws decl_stmt java.lang.String = for = < ++ + decl_stmt CheckDeleteBackupStatus = new while decl_stmt boolean = call CheckDeleteBackupStatus.fetchStatus() call CheckDeleteBackupStatus.fetchStatus() call CheckDeleteBackupStatus.fetchStatus() call CheckDeleteBackupStatus.fetchStatus() call CheckDeleteBackupStatus.fetchStatus() if = if == break URL String InputStream public static public static throws decl_stmt java.lang.String = call JettySolrRunner.getLocalPort() call JettySolrRunner.getLocalPort() call JettySolrRunner.getLocalPort() call JettySolrRunner.getLocalPort() call JettySolrRunner.getLocalPort() + + + + + decl_stmt java.io.InputStream = try decl_stmt java.net.URL = new = call java.net.URL.openStream() call java.net.URL.openStream() call java.net.URL.openStream() call java.net.URL.openStream() call java.net.URL.openStream() call java.io.InputStream.close() call java.io.InputStream.close() call java.io.InputStream.close() call java.io.InputStream.close() call java.io.InputStream.close() finally URL Matcher String InputStream public public throws decl_stmt java.lang.String = call JettySolrRunner.getLocalPort() call JettySolrRunner.getLocalPort() call JettySolrRunner.getLocalPort() call JettySolrRunner.getLocalPort() call JettySolrRunner.getLocalPort() + + + + decl_stmt java.net.URL decl_stmt java.io.InputStream = try = new = call java.net.URL.openStream() call java.net.URL.openStream() call java.net.URL.openStream() call java.net.URL.openStream() call java.net.URL.openStream() = if decl_stmt java.util.regex.Matcher = if call java.util.regex.Matcher.find(int) call java.util.regex.Matcher.find(int) call java.util.regex.Matcher.find(int) call java.util.regex.Matcher.find(int) call java.util.regex.Matcher.find(int) && == || ! call java.util.regex.Matcher.group(int) call java.util.regex.Matcher.group(int) call java.util.regex.Matcher.group(int) call java.util.regex.Matcher.group(int) call java.util.regex.Matcher.group(int) = call java.util.regex.Matcher.group(int) call java.util.regex.Matcher.group(int) call java.util.regex.Matcher.group(int) call java.util.regex.Matcher.group(int) call java.util.regex.Matcher.group(int) return else if + + return call java.io.InputStream.close() call java.io.InputStream.close() call java.io.InputStream.close() call java.io.InputStream.close() call java.io.InputStream.close() finally return