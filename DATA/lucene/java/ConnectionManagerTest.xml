org.apache.solr.cloud java.io.IOException import java.util.concurrent.Executors import java.util.concurrent.ScheduledExecutorService import java.util.concurrent.TimeUnit import org.apache.lucene.util.LuceneTestCase.Slow import org.apache.solr.SolrTestCaseJ4 import org.apache.solr.common.cloud.ConnectionManager import org.apache.solr.common.cloud.DefaultConnectionStrategy import org.apache.solr.common.cloud.OnReconnect import org.apache.solr.common.cloud.SolrZkClient import org.apache.solr.common.cloud.ZkClientConnectionStrategy import org.apache.solr.common.cloud.ZkClientConnectionStrategy.ZkUpdate import org.apache.solr.util.DefaultSolrThreadFactory import org.apache.zookeeper.WatchedEvent import org.apache.zookeeper.Watcher import org.apache.zookeeper.Watcher.Event.EventType import org.apache.zookeeper.Watcher.Event.KeeperState import org.junit.Ignore import org.junit.Test import class annotation org.apache.solr.cloud.ConnectionManagerTest super super extends int SolrZkClient long ZkTestServer ConnectionManager String public public throws decl_stmt java.lang.String = decl_stmt org.apache.solr.cloud.ZkTestServer = new try call org.apache.solr.cloud.ZkTestServer.run() call org.apache.solr.cloud.ZkTestServer.run() call org.apache.solr.cloud.ZkTestServer.run() call org.apache.solr.cloud.ZkTestServer.run() call org.apache.solr.cloud.ZkTestServer.run() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() decl_stmt org.apache.solr.common.cloud.SolrZkClient = new call org.apache.solr.cloud.ZkTestServer.getZkAddress() call org.apache.solr.cloud.ZkTestServer.getZkAddress() call org.apache.solr.cloud.ZkTestServer.getZkAddress() call org.apache.solr.cloud.ZkTestServer.getZkAddress() call org.apache.solr.cloud.ZkTestServer.getZkAddress() decl_stmt org.apache.solr.common.cloud.ConnectionManager = call org.apache.solr.common.cloud.SolrZkClient.getConnectionManager() call org.apache.solr.common.cloud.SolrZkClient.getConnectionManager() call org.apache.solr.common.cloud.SolrZkClient.getConnectionManager() call org.apache.solr.common.cloud.SolrZkClient.getConnectionManager() call org.apache.solr.common.cloud.SolrZkClient.getConnectionManager() try call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.SolrZkClient.getSolrZooKeeper() call org.apache.solr.common.cloud.SolrZkClient.getSolrZooKeeper() call org.apache.solr.common.cloud.SolrZkClient.getSolrZooKeeper() call org.apache.solr.common.cloud.SolrZkClient.getSolrZooKeeper() call org.apache.solr.common.cloud.SolrZkClient.getSolrZooKeeper() decl_stmt long = call org.apache.solr.common.cloud.SolrZkClient.getSolrZooKeeper() call org.apache.solr.common.cloud.SolrZkClient.getSolrZooKeeper() call org.apache.solr.common.cloud.SolrZkClient.getSolrZooKeeper() call org.apache.solr.common.cloud.SolrZkClient.getSolrZooKeeper() call org.apache.solr.common.cloud.SolrZkClient.getSolrZooKeeper() call org.apache.solr.cloud.ZkTestServer.expire(long) call org.apache.solr.cloud.ZkTestServer.expire(long) call org.apache.solr.cloud.ZkTestServer.expire(long) call org.apache.solr.cloud.ZkTestServer.expire(long) call org.apache.solr.cloud.ZkTestServer.expire(long) call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() finally call ConnectionManager.close() call ConnectionManager.close() call ConnectionManager.close() call ConnectionManager.close() call ConnectionManager.close() call org.apache.solr.common.cloud.SolrZkClient.close() call org.apache.solr.common.cloud.SolrZkClient.close() call org.apache.solr.common.cloud.SolrZkClient.close() call org.apache.solr.common.cloud.SolrZkClient.close() call org.apache.solr.common.cloud.SolrZkClient.close() finally call org.apache.solr.cloud.ZkTestServer.shutdown() call org.apache.solr.cloud.ZkTestServer.shutdown() call org.apache.solr.cloud.ZkTestServer.shutdown() call org.apache.solr.cloud.ZkTestServer.shutdown() call org.apache.solr.cloud.ZkTestServer.shutdown() SolrZkClient ZkTestServer ConnectionManager String public public throws decl_stmt java.lang.String = decl_stmt org.apache.solr.cloud.ZkTestServer = new try call org.apache.solr.cloud.ZkTestServer.run() call org.apache.solr.cloud.ZkTestServer.run() call org.apache.solr.cloud.ZkTestServer.run() call org.apache.solr.cloud.ZkTestServer.run() call org.apache.solr.cloud.ZkTestServer.run() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() decl_stmt org.apache.solr.common.cloud.SolrZkClient = new call org.apache.solr.cloud.ZkTestServer.getZkAddress() call org.apache.solr.cloud.ZkTestServer.getZkAddress() call org.apache.solr.cloud.ZkTestServer.getZkAddress() call org.apache.solr.cloud.ZkTestServer.getZkAddress() call org.apache.solr.cloud.ZkTestServer.getZkAddress() decl_stmt org.apache.solr.common.cloud.ConnectionManager = call org.apache.solr.common.cloud.SolrZkClient.getConnectionManager() call org.apache.solr.common.cloud.SolrZkClient.getConnectionManager() call org.apache.solr.common.cloud.SolrZkClient.getConnectionManager() call org.apache.solr.common.cloud.SolrZkClient.getConnectionManager() call org.apache.solr.common.cloud.SolrZkClient.getConnectionManager() try call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) new call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call SolrZkClient.getZkClientTimeout() call SolrZkClient.getZkClientTimeout() call SolrZkClient.getZkClientTimeout() call SolrZkClient.getZkClientTimeout() call SolrZkClient.getZkClientTimeout() * call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) new call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) new call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() finally call ConnectionManager.close() call ConnectionManager.close() call ConnectionManager.close() call ConnectionManager.close() call ConnectionManager.close() call org.apache.solr.common.cloud.SolrZkClient.close() call org.apache.solr.common.cloud.SolrZkClient.close() call org.apache.solr.common.cloud.SolrZkClient.close() call org.apache.solr.common.cloud.SolrZkClient.close() call org.apache.solr.common.cloud.SolrZkClient.close() finally call org.apache.solr.cloud.ZkTestServer.shutdown() call org.apache.solr.cloud.ZkTestServer.shutdown() call org.apache.solr.cloud.ZkTestServer.shutdown() call org.apache.solr.cloud.ZkTestServer.shutdown() call org.apache.solr.cloud.ZkTestServer.shutdown() ConnectionManager MockZkClientConnectionStrategy String ScheduledExecutorService SolrZkClient ZkTestServer public public throws decl_stmt java.util.concurrent.ScheduledExecutorService = new decl_stmt java.lang.String = decl_stmt org.apache.solr.cloud.ZkTestServer = new try call org.apache.solr.cloud.ZkTestServer.run() call org.apache.solr.cloud.ZkTestServer.run() call org.apache.solr.cloud.ZkTestServer.run() call org.apache.solr.cloud.ZkTestServer.run() call org.apache.solr.cloud.ZkTestServer.run() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() call org.apache.solr.cloud.ZkTestServer.getZkHost() decl_stmt MockZkClientConnectionStrategy = new decl_stmt org.apache.solr.common.cloud.SolrZkClient = new call org.apache.solr.cloud.ZkTestServer.getZkAddress() call org.apache.solr.cloud.ZkTestServer.getZkAddress() call org.apache.solr.cloud.ZkTestServer.getZkAddress() call org.apache.solr.cloud.ZkTestServer.getZkAddress() call org.apache.solr.cloud.ZkTestServer.getZkAddress() decl_stmt org.apache.solr.common.cloud.ConnectionManager = call org.apache.solr.common.cloud.SolrZkClient.getConnectionManager() call org.apache.solr.common.cloud.SolrZkClient.getConnectionManager() call org.apache.solr.common.cloud.SolrZkClient.getConnectionManager() call org.apache.solr.common.cloud.SolrZkClient.getConnectionManager() call org.apache.solr.common.cloud.SolrZkClient.getConnectionManager() try call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) call org.apache.solr.common.cloud.ConnectionManager.process(WatchedEvent) new call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isLikelyExpired() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call org.apache.solr.common.cloud.ConnectionManager.isConnected() call MockZkClientConnectionStrategy.isExceptionThrow() call MockZkClientConnectionStrategy.isExceptionThrow() call MockZkClientConnectionStrategy.isExceptionThrow() call MockZkClientConnectionStrategy.isExceptionThrow() call MockZkClientConnectionStrategy.isExceptionThrow() finally call ConnectionManager.close() call ConnectionManager.close() call ConnectionManager.close() call ConnectionManager.close() call ConnectionManager.close() call org.apache.solr.common.cloud.SolrZkClient.close() call org.apache.solr.common.cloud.SolrZkClient.close() call org.apache.solr.common.cloud.SolrZkClient.close() call org.apache.solr.common.cloud.SolrZkClient.close() call org.apache.solr.common.cloud.SolrZkClient.close() call ScheduledExecutorService.shutdown() call ScheduledExecutorService.shutdown() call ScheduledExecutorService.shutdown() call ScheduledExecutorService.shutdown() call ScheduledExecutorService.shutdown() finally call org.apache.solr.cloud.ZkTestServer.shutdown() call org.apache.solr.cloud.ZkTestServer.shutdown() call org.apache.solr.cloud.ZkTestServer.shutdown() call org.apache.solr.cloud.ZkTestServer.shutdown() call org.apache.solr.cloud.ZkTestServer.shutdown() public public final final final final final final final final throws if ++ < = throw new public public return