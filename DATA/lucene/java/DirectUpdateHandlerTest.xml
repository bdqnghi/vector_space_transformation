org.apache.solr.update java.lang.invoke.MethodHandles import java.util.Arrays import java.util.HashMap import java.util.Map import java.util.concurrent.atomic.AtomicInteger import java.util.concurrent.atomic.AtomicLong import org.apache.lucene.index.TieredMergePolicy import org.apache.lucene.index.DirectoryReader import org.apache.lucene.store.Directory import org.apache.solr.SolrTestCaseJ4 import org.apache.solr.common.params.CommonParams import org.apache.solr.common.params.MapSolrParams import org.apache.solr.common.util.NamedList import org.apache.solr.core.SolrCore import org.apache.solr.core.SolrEventListener import org.apache.solr.index.TieredMergePolicyFactory import org.apache.solr.request.LocalSolrQueryRequest import org.apache.solr.request.SolrQueryRequest import org.apache.solr.search.SolrIndexSearcher import org.junit.AfterClass import org.junit.Before import org.junit.BeforeClass import org.junit.Test import org.slf4j.Logger import org.slf4j.LoggerFactory import class org.apache.solr.update.DirectUpdateHandlerTest super super extends String Logger public static public static throws = public static public static if == else public public throws public public throws public public throws + + SolrCore SolrQueryRequest CommitUpdateCommand decl Map SolrQueryRequest UpdateHandler DirectUpdateHandler2 RollbackUpdateCommand public public throws decl_stmt org.apache.solr.core.SolrCore = decl_stmt org.apache.solr.update.UpdateHandler = call org.apache.solr.core.SolrCore.getUpdateHandler() call org.apache.solr.core.SolrCore.getUpdateHandler() call org.apache.solr.core.SolrCore.getUpdateHandler() call org.apache.solr.core.SolrCore.getUpdateHandler() call org.apache.solr.core.SolrCore.getUpdateHandler() instanceof decl_stmt org.apache.solr.update.DirectUpdateHandler2 = decl_stmt org.apache.solr.request.SolrQueryRequest = decl_stmt org.apache.solr.update.CommitUpdateCommand = new = call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call UpdateHandler.commit() call UpdateHandler.commit() call UpdateHandler.commit() call UpdateHandler.commit() call UpdateHandler.commit() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() = decl_stmt org.apache.solr.update.RollbackUpdateCommand = new call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call UpdateHandler.rollback() call UpdateHandler.rollback() call UpdateHandler.rollback() call UpdateHandler.rollback() call UpdateHandler.rollback() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() decl_stmt java.util.Map < = new <> call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() decl_stmt org.apache.solr.request.SolrQueryRequest = new new SolrCore SolrQueryRequest CommitUpdateCommand decl Map SolrQueryRequest UpdateHandler RollbackUpdateCommand DirectUpdateHandler2 public public throws decl_stmt org.apache.solr.core.SolrCore = decl_stmt org.apache.solr.update.UpdateHandler = call org.apache.solr.core.SolrCore.getUpdateHandler() call org.apache.solr.core.SolrCore.getUpdateHandler() call org.apache.solr.core.SolrCore.getUpdateHandler() call org.apache.solr.core.SolrCore.getUpdateHandler() call org.apache.solr.core.SolrCore.getUpdateHandler() instanceof decl_stmt org.apache.solr.update.DirectUpdateHandler2 = decl_stmt org.apache.solr.request.SolrQueryRequest = decl_stmt org.apache.solr.update.CommitUpdateCommand = new = call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call UpdateHandler.commit() call UpdateHandler.commit() call UpdateHandler.commit() call UpdateHandler.commit() call UpdateHandler.commit() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommands() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.addCommandsCumulative() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call DirectUpdateHandler2.commitCommands() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() decl_stmt java.util.Map < = new <> call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() decl_stmt org.apache.solr.request.SolrQueryRequest = new new = decl_stmt org.apache.solr.update.RollbackUpdateCommand = new call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call UpdateHandler.rollback() call UpdateHandler.rollback() call UpdateHandler.rollback() call UpdateHandler.rollback() call UpdateHandler.rollback() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommands() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.deleteByIdCommandsCumulative() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() call DirectUpdateHandler2.rollbackCommands() SolrQueryRequest DirectoryReader public public throws decl_stmt org.apache.solr.request.SolrQueryRequest = decl_stmt org.apache.lucene.index.DirectoryReader = call org.apache.solr.request.SolrQueryRequest.getSearcher() call org.apache.solr.request.SolrQueryRequest.getSearcher() call org.apache.solr.request.SolrQueryRequest.getSearcher() call org.apache.solr.request.SolrQueryRequest.getSearcher() call org.apache.solr.request.SolrQueryRequest.getSearcher() call DirectoryReader.maxDoc() call DirectoryReader.maxDoc() call DirectoryReader.maxDoc() call DirectoryReader.maxDoc() call DirectoryReader.maxDoc() > call DirectoryReader.numDocs() call DirectoryReader.numDocs() call DirectoryReader.numDocs() call DirectoryReader.numDocs() call DirectoryReader.numDocs() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() = = call org.apache.solr.request.SolrQueryRequest.getSearcher() call org.apache.solr.request.SolrQueryRequest.getSearcher() call org.apache.solr.request.SolrQueryRequest.getSearcher() call org.apache.solr.request.SolrQueryRequest.getSearcher() call org.apache.solr.request.SolrQueryRequest.getSearcher() call DirectoryReader.maxDoc() call DirectoryReader.maxDoc() call DirectoryReader.maxDoc() call DirectoryReader.maxDoc() call DirectoryReader.maxDoc() call DirectoryReader.numDocs() call DirectoryReader.numDocs() call DirectoryReader.numDocs() call DirectoryReader.numDocs() call DirectoryReader.numDocs() call DirectoryReader.maxDoc() call DirectoryReader.maxDoc() call DirectoryReader.maxDoc() call DirectoryReader.maxDoc() call DirectoryReader.maxDoc() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() SolrQueryRequest DirectoryReader Directory int public public throws decl_stmt org.apache.solr.request.SolrQueryRequest = decl_stmt org.apache.lucene.index.DirectoryReader = call org.apache.solr.request.SolrQueryRequest.getSearcher() call org.apache.solr.request.SolrQueryRequest.getSearcher() call org.apache.solr.request.SolrQueryRequest.getSearcher() call org.apache.solr.request.SolrQueryRequest.getSearcher() call org.apache.solr.request.SolrQueryRequest.getSearcher() decl_stmt org.apache.lucene.store.Directory = call org.apache.lucene.index.DirectoryReader.directory() call org.apache.lucene.index.DirectoryReader.directory() call org.apache.lucene.index.DirectoryReader.directory() call org.apache.lucene.index.DirectoryReader.directory() call org.apache.lucene.index.DirectoryReader.directory() call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) + call Directory.listAll() call Directory.listAll() call Directory.listAll() call Directory.listAll() call Directory.listAll() decl_stmt int = call Directory.listAll() call Directory.listAll() call Directory.listAll() call Directory.listAll() call Directory.listAll() call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) + call Directory.listAll() call Directory.listAll() call Directory.listAll() call Directory.listAll() call Directory.listAll() call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) + call Directory.listAll() call Directory.listAll() call Directory.listAll() call Directory.listAll() call Directory.listAll() call Directory.listAll() call Directory.listAll() call Directory.listAll() call Directory.listAll() call Directory.listAll() > call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() call org.apache.solr.request.SolrQueryRequest.close() MySolrEventListener SolrCore DirectUpdateHandler2 public public throws decl_stmt org.apache.solr.core.SolrCore = assert != decl_stmt org.apache.solr.update.DirectUpdateHandler2 = call org.apache.solr.core.SolrCore.getUpdateHandler() call org.apache.solr.core.SolrCore.getUpdateHandler() call org.apache.solr.core.SolrCore.getUpdateHandler() call org.apache.solr.core.SolrCore.getUpdateHandler() call org.apache.solr.core.SolrCore.getUpdateHandler() decl_stmt MySolrEventListener = new call org.apache.solr.core.SolrCore.registerNewSearcherListener(SolrEventListener) call org.apache.solr.core.SolrCore.registerNewSearcherListener(SolrEventListener) call org.apache.solr.core.SolrCore.registerNewSearcherListener(SolrEventListener) call org.apache.solr.core.SolrCore.registerNewSearcherListener(SolrEventListener) call org.apache.solr.core.SolrCore.registerNewSearcherListener(SolrEventListener) call DirectUpdateHandler2.registerSoftCommitCallback() call DirectUpdateHandler2.registerSoftCommitCallback() call DirectUpdateHandler2.registerSoftCommitCallback() call DirectUpdateHandler2.registerSoftCommitCallback() call DirectUpdateHandler2.registerSoftCommitCallback() call MySolrEventListener.newSearcherCount() call MySolrEventListener.newSearcherCount() call MySolrEventListener.newSearcherCount() call MySolrEventListener.newSearcherCount() call MySolrEventListener.newSearcherCount() call MySolrEventListener.newSearcherCount() call MySolrEventListener.newSearcherCount() call MySolrEventListener.newSearcherCount() call MySolrEventListener.newSearcherCount() call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() == call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() call MySolrEventListener.postSoftCommitAt() >= call MySolrEventListener.newSearcherOpenedAt() call MySolrEventListener.newSearcherOpenedAt() call MySolrEventListener.newSearcherOpenedAt() call MySolrEventListener.newSearcherOpenedAt() call MySolrEventListener.newSearcherOpenedAt() call MySolrEventListener.newSearcherOpenedAt() call MySolrEventListener.newSearcherOpenedAt() call MySolrEventListener.newSearcherOpenedAt() call MySolrEventListener.newSearcherOpenedAt() public public public public public public public public