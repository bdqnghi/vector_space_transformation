org.apache.solr.hadoop java.io.File import java.io.IOException import java.io.OutputStream import java.io.OutputStreamWriter import java.io.Writer import java.lang.reflect.Array import java.nio.charset.StandardCharsets import java.util.Arrays import org.apache.commons.io.FileUtils import org.apache.hadoop.conf.Configuration import org.apache.hadoop.fs.FileSystem import org.apache.hadoop.fs.FileUtil import org.apache.hadoop.fs.Path import org.apache.hadoop.fs.permission.FsPermission import org.apache.hadoop.hdfs.MiniDFSCluster import org.apache.hadoop.mapred.JobConf import org.apache.hadoop.mapreduce.Job import org.apache.hadoop.security.authorize.ProxyUsers import org.apache.hadoop.util.JarFinder import org.apache.hadoop.util.ToolRunner import org.apache.hadoop.yarn.conf.YarnConfiguration import org.apache.lucene.util.Constants import org.apache.lucene.util.LuceneTestCase.Slow import org.apache.solr.SolrTestCaseJ4 import org.apache.solr.cloud.AbstractZkTestCase import org.apache.solr.hadoop.hack.MiniMRCluster import org.apache.solr.morphlines.solr.AbstractSolrMorphlineTestBase import org.apache.solr.util.BadHdfsThreadsFilter import org.apache.solr.util.BadMrClusterThreadsFilter import org.junit.After import org.junit.AfterClass import org.junit.BeforeClass import org.junit.Test import com.carrotsearch.randomizedtesting.annotations.Nightly import com.carrotsearch.randomizedtesting.annotations.ThreadLeakAction import com.carrotsearch.randomizedtesting.annotations.ThreadLeakAction.Action import com.carrotsearch.randomizedtesting.annotations.ThreadLeakFilters import com.carrotsearch.randomizedtesting.annotations.ThreadLeakLingering import com.carrotsearch.randomizedtesting.annotations.ThreadLeakZombies import com.carrotsearch.randomizedtesting.annotations.ThreadLeakZombies.Consequence import class annotation annotation annotation annotation annotation annotation org.apache.solr.hadoop.MorphlineBasicMiniMRTest super super extends int String File MiniDFSCluster String int File String String boolean String MiniMRCluster protected protected return new String int File int int JobConf FileSystem decl String decl String public static public static throws = = decl_stmt File = = call File.getAbsolutePath() call File.getAbsolutePath() call File.getAbsolutePath() call File.getAbsolutePath() call File.getAbsolutePath() new new + new + new decl_stmt int = decl_stmt int = new + + + + + + + + + + + + = decl_stmt JobConf = new call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call File.getPath() call File.getPath() call File.getPath() call File.getPath() call File.getPath() + + call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() + + call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call File.getPath() call File.getPath() call File.getPath() call File.getPath() call File.getPath() + + call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() = new decl_stmt java.io.FileSystem = call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() new call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() new call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() new call FileSystem.setPermission() call FileSystem.setPermission() call FileSystem.setPermission() call FileSystem.setPermission() call FileSystem.setPermission() new call FileSystem.setPermission() call FileSystem.setPermission() call FileSystem.setPermission() call FileSystem.setPermission() call FileSystem.setPermission() new call FileSystem.setPermission() call FileSystem.setPermission() call FileSystem.setPermission() call FileSystem.setPermission() call FileSystem.setPermission() new decl_stmt java.lang.String = call FileSystem.getUri() call FileSystem.getUri() call FileSystem.getUri() call FileSystem.getUri() call FileSystem.getUri() decl_stmt int = decl_stmt java.lang.String = decl_stmt java.lang.String = = new public static public static throws if != call org.apache.solr.hadoop.hack.MiniMRCluster.shutdown() call org.apache.solr.hadoop.hack.MiniMRCluster.shutdown() call org.apache.solr.hadoop.hack.MiniMRCluster.shutdown() call org.apache.solr.hadoop.hack.MiniMRCluster.shutdown() call org.apache.solr.hadoop.hack.MiniMRCluster.shutdown() = if != call MiniDFSCluster.shutdown() call MiniDFSCluster.shutdown() call MiniDFSCluster.shutdown() call MiniDFSCluster.shutdown() call MiniDFSCluster.shutdown() = public public throws private private return call org.apache.solr.hadoop.hack.MiniMRCluster.createJobConf() call org.apache.solr.hadoop.hack.MiniMRCluster.createJobConf() call org.apache.solr.hadoop.hack.MiniMRCluster.createJobConf() call org.apache.solr.hadoop.hack.MiniMRCluster.createJobConf() call org.apache.solr.hadoop.hack.MiniMRCluster.createJobConf() FileSystem String String String PathParts JobConf Configuration int public public throws decl_stmt java.io.FileSystem = call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() decl_stmt int = call FileSystem.getWorkingDirectory() call FileSystem.getWorkingDirectory() call FileSystem.getWorkingDirectory() call FileSystem.getWorkingDirectory() call FileSystem.getWorkingDirectory() > decl_stmt JobConf = decl_stmt Configuration = new for : for : for : decl_stmt java.lang.String = == : decl_stmt java.lang.String = + + + decl_stmt org.apache.solr.hadoop.PathParts = new call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() + + call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() + + call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getDownloadURL() call org.apache.solr.hadoop.PathParts.getDownloadURL() call org.apache.solr.hadoop.PathParts.getDownloadURL() call org.apache.solr.hadoop.PathParts.getDownloadURL() call org.apache.solr.hadoop.PathParts.getDownloadURL() = + + + = new call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() + + call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() + + call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getDownloadURL() call org.apache.solr.hadoop.PathParts.getDownloadURL() call org.apache.solr.hadoop.PathParts.getDownloadURL() call org.apache.solr.hadoop.PathParts.getDownloadURL() call org.apache.solr.hadoop.PathParts.getDownloadURL() for : for : for : decl_stmt java.lang.String = == : decl_stmt java.lang.String = + + + decl_stmt org.apache.solr.hadoop.PathParts = new call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() + + call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() || call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() + + + + || call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() + + + + = + + + = new call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() call org.apache.solr.hadoop.PathParts.getUploadURL() decl_stmt java.lang.String = + + + + call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getURIPath() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getName() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call org.apache.solr.hadoop.PathParts.getScheme() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() || call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call PathParts.getHost() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getPort() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() + + + + + || call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() call org.apache.solr.hadoop.PathParts.getId() + + + + + try new catch private private try catch FileSystem Job int MapReduceIndexerTool decl String Path int String decl Path Writer JobConf int Path OutputStream Path Path public public throws decl_stmt java.io.FileSystem = call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() decl_stmt java.nio.file.Path = call FileSystem.makeQualified() call FileSystem.makeQualified() call FileSystem.makeQualified() call FileSystem.makeQualified() call FileSystem.makeQualified() new call FileSystem.delete() call FileSystem.delete() call FileSystem.delete() call FileSystem.delete() call FileSystem.delete() decl_stmt java.lang.String = decl_stmt java.nio.file.Path = call FileSystem.makeQualified() call FileSystem.makeQualified() call FileSystem.makeQualified() call FileSystem.makeQualified() call FileSystem.makeQualified() new call FileSystem.delete() call FileSystem.delete() call FileSystem.delete() call FileSystem.delete() call FileSystem.delete() decl_stmt java.nio.file.Path = call FileSystem.makeQualified() call FileSystem.makeQualified() call FileSystem.makeQualified() call FileSystem.makeQualified() call FileSystem.makeQualified() new call FileSystem.delete() call FileSystem.delete() call FileSystem.delete() call FileSystem.delete() call FileSystem.delete() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() decl_stmt java.nio.file.Path = new decl_stmt java.io.OutputStream = call FileSystem.create() call FileSystem.create() call FileSystem.create() call FileSystem.create() call FileSystem.create() decl_stmt Writer = new call Writer.write() call Writer.write() call Writer.write() call Writer.write() call Writer.write() + + call Writer.close() call Writer.close() call Writer.close() call Writer.close() call Writer.close() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.copyFromLocalFile() call FileSystem.copyFromLocalFile() call FileSystem.copyFromLocalFile() call FileSystem.copyFromLocalFile() call FileSystem.copyFromLocalFile() new decl_stmt JobConf = call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() if call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.set() call JobConf.setMaxMapAttempts() call JobConf.setMaxMapAttempts() call JobConf.setMaxMapAttempts() call JobConf.setMaxMapAttempts() call JobConf.setMaxMapAttempts() call JobConf.setMaxReduceAttempts() call JobConf.setMaxReduceAttempts() call JobConf.setMaxReduceAttempts() call JobConf.setMaxReduceAttempts() call JobConf.setMaxReduceAttempts() call JobConf.setJar() call JobConf.setJar() call JobConf.setJar() call JobConf.setJar() call JobConf.setJar() decl_stmt int = decl_stmt int = if = = decl_stmt java.lang.String = new + + + call File.getAbsolutePath() call File.getAbsolutePath() call File.getAbsolutePath() call File.getAbsolutePath() call File.getAbsolutePath() + call java.nio.file.Path.toString() call java.nio.file.Path.toString() call java.nio.file.Path.toString() call java.nio.file.Path.toString() call java.nio.file.Path.toString() + == + call java.nio.file.Path.toString() call java.nio.file.Path.toString() call java.nio.file.Path.toString() call java.nio.file.Path.toString() call java.nio.file.Path.toString() : call java.nio.file.Path.toString() call java.nio.file.Path.toString() call java.nio.file.Path.toString() call java.nio.file.Path.toString() call java.nio.file.Path.toString() == + : == : + if == = new if == = new + decl_stmt org.apache.solr.hadoop.MapReduceIndexerTool = decl_stmt int = decl_stmt Job = call Job.isComplete() call Job.isComplete() call Job.isComplete() call Job.isComplete() call Job.isComplete() call Job.isSuccessful() call Job.isSuccessful() call Job.isSuccessful() call Job.isSuccessful() call Job.isSuccessful() if != + + + call Job.getCounters() call Job.getCounters() call Job.getCounters() call Job.getCounters() call Job.getCounters() = new decl_stmt java.nio.file.Path = call FileSystem.listStatus() call FileSystem.listStatus() call FileSystem.listStatus() call FileSystem.listStatus() call FileSystem.listStatus() + = = new = ++ int int decl T Class protected static < protected static < if <= throw new decl_stmt java.lang.Class = decl_stmt int = for : = += decl_stmt T = call Class.getComponentType() call Class.getComponentType() call Class.getComponentType() call Class.getComponentType() call Class.getComponentType() decl_stmt int = for : += return