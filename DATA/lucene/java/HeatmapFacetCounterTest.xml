org.apache.lucene.spatial.prefix java.io.IOException import java.util.ArrayList import java.util.List import com.carrotsearch.randomizedtesting.annotations.Repeat import org.locationtech.spatial4j.context.SpatialContext import org.locationtech.spatial4j.context.SpatialContextFactory import org.locationtech.spatial4j.distance.DistanceUtils import org.locationtech.spatial4j.shape.Circle import org.locationtech.spatial4j.shape.Point import org.locationtech.spatial4j.shape.Rectangle import org.locationtech.spatial4j.shape.Shape import org.locationtech.spatial4j.shape.SpatialRelation import org.locationtech.spatial4j.shape.impl.RectangleImpl import org.apache.lucene.search.Query import org.apache.lucene.search.TotalHitCountCollector import org.apache.lucene.spatial.StrategyTestCase import org.apache.lucene.spatial.prefix.tree.QuadPrefixTree import org.apache.lucene.spatial.prefix.tree.SpatialPrefixTree import org.apache.lucene.util.Bits import org.junit.After import org.junit.Before import org.junit.Test import static static com.carrotsearch.randomizedtesting.RandomizedTest.atMost import static static com.carrotsearch.randomizedtesting.RandomizedTest.randomIntBetween import class org.apache.lucene.spatial.prefix.HeatmapFacetCounterTest super super extends int SpatialPrefixTree int public public throws = = = = new = new if public public + + + + public public throws - - - - - - + + - - - - - - - - SpatialContextFactory decl Heatmap Circle decl HeatmapFacetCounter int public public throws decl_stmt SpatialContextFactory final final = new = = new - - = call SpatialContextFactory.newSpatialContext() call SpatialContextFactory.newSpatialContext() call SpatialContextFactory.newSpatialContext() call SpatialContextFactory.newSpatialContext() call SpatialContextFactory.newSpatialContext() decl_stmt int final final = = new = new decl_stmt Circle = decl_stmt Heatmap final final final final final = decl_stmt boolean = for : switch case break case = break default: + decl HeatmapFacetCounter decl Heatmap int private private throws if > call SpatialPrefixTree.getMaxLevels() call SpatialPrefixTree.getMaxLevels() call SpatialPrefixTree.getMaxLevels() call SpatialPrefixTree.getMaxLevels() call SpatialPrefixTree.getMaxLevels() return decl_stmt int final final = decl_stmt Heatmap final final final final final = decl_stmt int = assert - > if < + decl List double Shape int Rectangle = public = public throws decl_stmt int final final = + decl_stmt java.util.List < = new <> for = < ++ call decl List.add() call decl List.add() call decl List.add() call decl List.add() call decl List.add() for = < call decl List.size() call decl List.size() call decl List.size() call decl List.size() call decl List.size() ++ decl_stmt java.awt.Shape = call decl List.get() call decl List.get() call decl List.get() call decl List.get() call decl List.get() + if == for = < call decl List.size() call decl List.size() call decl List.size() call decl List.size() call decl List.size() ++ if == + call decl List.set() call decl List.set() call decl List.set() call decl List.set() call decl List.set() decl_stmt org.apache.lucene.geo.Rectangle final final = : if call java.awt.Rectangle.getWidth() call java.awt.Rectangle.getWidth() call java.awt.Rectangle.getWidth() call java.awt.Rectangle.getWidth() call java.awt.Rectangle.getWidth() > decl_stmt double = call java.awt.Rectangle.getWidth() call java.awt.Rectangle.getWidth() call java.awt.Rectangle.getWidth() call java.awt.Rectangle.getWidth() call java.awt.Rectangle.getWidth() call Rectangle.getMinX() call Rectangle.getMinX() call Rectangle.getMinX() call Rectangle.getMinX() call Rectangle.getMinX() - call Rectangle.getMaxX() call Rectangle.getMaxX() call Rectangle.getMaxX() call Rectangle.getMaxX() call Rectangle.getMaxX() - call Rectangle.getMinY() call Rectangle.getMinY() call Rectangle.getMinY() call Rectangle.getMinY() call Rectangle.getMinY() call Rectangle.getMaxY() call Rectangle.getMaxY() call Rectangle.getMaxY() call Rectangle.getMaxY() call Rectangle.getMaxY() Bits decl Heatmap decl HeatmapFacetCounter int private private throws if ! return decl_stmt org.apache.lucene.util.Bits = decl_stmt int final final = decl_stmt Heatmap final final final final final = decl_stmt boolean = for : if > = break if && <= && != call SpatialPrefixTree.getMaxLevels() call SpatialPrefixTree.getMaxLevels() call SpatialPrefixTree.getMaxLevels() call SpatialPrefixTree.getMaxLevels() call SpatialPrefixTree.getMaxLevels() && for = < ++ if + break return double Point Rectangle int double double double private private throws decl_stmt org.apache.lucene.geo.Rectangle final final = call Rectangle.relate() call Rectangle.relate() call Rectangle.relate() call Rectangle.relate() call Rectangle.relate() == || call java.awt.Rectangle.equals(Object) call java.awt.Rectangle.equals(Object) call java.awt.Rectangle.equals(Object) call java.awt.Rectangle.equals(Object) call java.awt.Rectangle.equals(Object) decl_stmt double final final = call java.awt.Rectangle.getWidth() call java.awt.Rectangle.getWidth() call java.awt.Rectangle.getWidth() call java.awt.Rectangle.getWidth() call java.awt.Rectangle.getWidth() / decl_stmt double final final = call java.awt.Rectangle.getHeight() call java.awt.Rectangle.getHeight() call java.awt.Rectangle.getHeight() call java.awt.Rectangle.getHeight() call java.awt.Rectangle.getHeight() / for = < ++ for = < ++ decl_stmt int final final = decl_stmt double = call Rectangle.getMinX() call Rectangle.getMinX() call Rectangle.getMinX() call Rectangle.getMinX() call Rectangle.getMinX() + * + / decl_stmt double = call Rectangle.getMinY() call Rectangle.getMinY() call Rectangle.getMinY() call Rectangle.getMinY() call Rectangle.getMinY() + * + / decl_stmt java.awt.Point = Query TotalHitCountCollector RecursivePrefixTreeStrategy private private throws decl_stmt org.apache.lucene.spatial.prefix.RecursivePrefixTreeStrategy = decl_stmt org.apache.lucene.search.Query = new call RecursivePrefixTreeStrategy.getFieldName() call RecursivePrefixTreeStrategy.getFieldName() call RecursivePrefixTreeStrategy.getFieldName() call RecursivePrefixTreeStrategy.getFieldName() call RecursivePrefixTreeStrategy.getFieldName() call SpatialPrefixTree.getMaxLevels() call SpatialPrefixTree.getMaxLevels() call SpatialPrefixTree.getMaxLevels() call SpatialPrefixTree.getMaxLevels() call SpatialPrefixTree.getMaxLevels() decl_stmt org.apache.lucene.search.TotalHitCountCollector final final = new ++ if call org.apache.lucene.search.TotalHitCountCollector.getTotalHits() call org.apache.lucene.search.TotalHitCountCollector.getTotalHits() call org.apache.lucene.search.TotalHitCountCollector.getTotalHits() call org.apache.lucene.search.TotalHitCountCollector.getTotalHits() call org.apache.lucene.search.TotalHitCountCollector.getTotalHits() > ++ return call org.apache.lucene.search.TotalHitCountCollector.getTotalHits() call org.apache.lucene.search.TotalHitCountCollector.getTotalHits() call org.apache.lucene.search.TotalHitCountCollector.getTotalHits() call org.apache.lucene.search.TotalHitCountCollector.getTotalHits() call org.apache.lucene.search.TotalHitCountCollector.getTotalHits() private private if || return else return