org.apache.solr.hadoop java.io.IOException import java.io.OutputStream import java.io.OutputStreamWriter import java.io.Writer import java.lang.invoke.MethodHandles import java.nio.charset.StandardCharsets import java.util.ArrayList import java.util.List import org.apache.hadoop.fs.Path import org.apache.hadoop.io.NullWritable import org.apache.hadoop.io.Text import org.apache.hadoop.mapreduce.RecordWriter import org.apache.hadoop.mapreduce.TaskAttemptContext import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat import org.apache.lucene.index.IndexWriter import org.apache.lucene.index.IndexWriterConfig import org.apache.lucene.index.IndexWriterConfig.OpenMode import org.apache.lucene.index.LogMergePolicy import org.apache.lucene.index.MergePolicy import org.apache.lucene.index.TieredMergePolicy import org.apache.lucene.misc.IndexMergeTool import org.apache.lucene.store.Directory import org.apache.lucene.store.NoLockFactory import org.apache.solr.store.hdfs.HdfsDirectory import org.apache.solr.util.RTimer import org.slf4j.Logger import org.slf4j.LoggerFactory import com.google.common.base.Preconditions import class org.apache.solr.hadoop.TreeMergeOutputFormat super super extends Logger Path public public throws decl_stmt java.nio.file.Path = return new Path public public try decl_stmt java.nio.file.Path = new finally MergePolicy IndexWriter RTimer decl Directory Directory int IndexWriterConfig public public throws + + + + + try decl_stmt org.apache.lucene.store.Directory = new decl_stmt org.apache.lucene.index.IndexWriterConfig = new if call org.apache.lucene.index.IndexWriterConfig.setInfoStream(InfoStream) call org.apache.lucene.index.IndexWriterConfig.setInfoStream(InfoStream) call org.apache.lucene.index.IndexWriterConfig.setInfoStream(InfoStream) call org.apache.lucene.index.IndexWriterConfig.setInfoStream(InfoStream) call org.apache.lucene.index.IndexWriterConfig.setInfoStream(InfoStream) decl_stmt org.apache.lucene.index.MergePolicy = call org.apache.lucene.index.IndexWriterConfig.getMergePolicy() call org.apache.lucene.index.IndexWriterConfig.getMergePolicy() call org.apache.lucene.index.IndexWriterConfig.getMergePolicy() call org.apache.lucene.index.IndexWriterConfig.getMergePolicy() call org.apache.lucene.index.IndexWriterConfig.getMergePolicy() if instanceof else if instanceof decl_stmt org.apache.lucene.index.IndexWriter = new decl_stmt org.apache.lucene.store.Directory = new for = < ++ = new + + + + + decl_stmt org.apache.solr.util.RTimer = new call org.apache.lucene.index.IndexWriter.addIndexes(Directory) call org.apache.lucene.index.IndexWriter.addIndexes(Directory) call org.apache.lucene.index.IndexWriter.addIndexes(Directory) call org.apache.lucene.index.IndexWriter.addIndexes(Directory) call org.apache.lucene.index.IndexWriter.addIndexes(Directory) call org.apache.solr.util.RTimer.stop() call org.apache.solr.util.RTimer.stop() call org.apache.solr.util.RTimer.stop() call org.apache.solr.util.RTimer.stop() call org.apache.solr.util.RTimer.stop() if long call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() decl_stmt int = + + = new if < call org.apache.lucene.index.IndexWriter.forceMerge(int) call org.apache.lucene.index.IndexWriter.forceMerge(int) call org.apache.lucene.index.IndexWriter.forceMerge(int) call org.apache.lucene.index.IndexWriter.forceMerge(int) call org.apache.lucene.index.IndexWriter.forceMerge(int) call org.apache.solr.util.RTimer.stop() call org.apache.solr.util.RTimer.stop() call org.apache.solr.util.RTimer.stop() call org.apache.solr.util.RTimer.stop() call org.apache.solr.util.RTimer.stop() if long call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() = new call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() call org.apache.solr.util.RTimer.getTime() finally int int Writer String String Path OutputStream private private throws > decl_stmt java.lang.String = decl_stmt java.lang.String = call java.lang.String.substring(int) call java.lang.String.substring(int) call java.lang.String.substring(int) call java.lang.String.substring(int) call java.lang.String.substring(int) call java.lang.String.length() call java.lang.String.length() call java.lang.String.length() call java.lang.String.length() call java.lang.String.length() decl_stmt int = decl_stmt int = / + + + decl_stmt java.nio.file.Path = new decl_stmt java.io.OutputStream = call java.nio.file.Path.getFileSystem() call java.nio.file.Path.getFileSystem() call java.nio.file.Path.getFileSystem() call java.nio.file.Path.getFileSystem() call java.nio.file.Path.getFileSystem() decl_stmt Writer = new call Writer.write() call Writer.write() call Writer.write() call Writer.write() call Writer.write() call Writer.flush() call Writer.flush() call Writer.flush() call Writer.flush() call Writer.flush() call Writer.close() call Writer.close() call Writer.close() call Writer.close() call Writer.close()