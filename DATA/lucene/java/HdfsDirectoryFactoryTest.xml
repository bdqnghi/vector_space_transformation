org.apache.solr.core java.io.IOException import java.nio.file.Path import java.text.SimpleDateFormat import java.util.Collections import java.util.Date import java.util.HashMap import java.util.Iterator import java.util.Locale import java.util.Map import org.apache.hadoop.conf.Configuration import org.apache.hadoop.fs.FileSystem import org.apache.hadoop.hdfs.MiniDFSCluster import org.apache.lucene.store.Directory import org.apache.lucene.store.IndexOutput import org.apache.lucene.store.LockFactory import org.apache.lucene.store.NoLockFactory import org.apache.solr.SolrTestCaseJ4 import org.apache.solr.cloud.hdfs.HdfsTestUtil import org.apache.solr.common.util.NamedList import org.apache.solr.core.DirectoryFactory.DirContext import org.apache.solr.handler.SnapShooter import org.apache.solr.store.hdfs.HdfsLocalityReporter import org.apache.solr.util.BadHdfsThreadsFilter import org.apache.solr.util.MockCoreContainer.MockCoreDescriptor import org.junit.After import org.junit.AfterClass import org.junit.Before import org.junit.BeforeClass import org.junit.Test import com.carrotsearch.randomizedtesting.annotations.ThreadLeakFilters import class annotation org.apache.solr.core.HdfsDirectoryFactoryTest super super extends MiniDFSCluster public static public static throws = public static public static throws = Path HdfsDirectoryFactory decl NamedList String Directory public public throws decl_stmt org.apache.solr.core.HdfsDirectoryFactory = new + call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) new <> decl_stmt java.lang.String = call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) new call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) decl_stmt org.apache.solr.common.util.NamedList < = new <> call decl NamedList.add() call decl NamedList.add() call decl NamedList.add() call decl NamedList.add() call decl NamedList.add() + call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) = call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) new call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) + call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) = call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) new call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) decl_stmt java.nio.file.Path = call java.nio.file.Path.toString() call java.nio.file.Path.toString() call java.nio.file.Path.toString() call java.nio.file.Path.toString() call java.nio.file.Path.toString() decl_stmt org.apache.lucene.store.Directory = call org.apache.solr.core.HdfsDirectoryFactory.create(String,LockFactory,DirContext) call org.apache.solr.core.HdfsDirectoryFactory.create(String,LockFactory,DirContext) call org.apache.solr.core.HdfsDirectoryFactory.create(String,LockFactory,DirContext) call org.apache.solr.core.HdfsDirectoryFactory.create(String,LockFactory,DirContext) call org.apache.solr.core.HdfsDirectoryFactory.create(String,LockFactory,DirContext) + try call java.nio.file.Path.toString() call java.nio.file.Path.toString() call java.nio.file.Path.toString() call java.nio.file.Path.toString() call java.nio.file.Path.toString() call org.apache.solr.core.HdfsDirectoryFactory.getConfDir() call org.apache.solr.core.HdfsDirectoryFactory.getConfDir() call org.apache.solr.core.HdfsDirectoryFactory.getConfDir() call org.apache.solr.core.HdfsDirectoryFactory.getConfDir() call org.apache.solr.core.HdfsDirectoryFactory.getConfDir() finally call Directory.close() call Directory.close() call Directory.close() call Directory.close() call Directory.close() = new <> call decl NamedList.add() call decl NamedList.add() call decl NamedList.add() call decl NamedList.add() call decl NamedList.add() call decl NamedList.add() call decl NamedList.add() call decl NamedList.add() call decl NamedList.add() call decl NamedList.add() call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) = new <> call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.getConfig(String,int) call org.apache.solr.core.HdfsDirectoryFactory.close() call org.apache.solr.core.HdfsDirectoryFactory.close() call org.apache.solr.core.HdfsDirectoryFactory.close() call org.apache.solr.core.HdfsDirectoryFactory.close() call org.apache.solr.core.HdfsDirectoryFactory.close() decl apache FileSystem HdfsDirectoryFactory decl org decl fs String decl hadoop public public throws decl_stmt org.apache.solr.core.HdfsDirectoryFactory = new + call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) new <> decl_stmt java.lang.String = call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) call org.apache.solr.core.HdfsDirectoryFactory.getDataHome(CoreDescriptor) new call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) call java.lang.String.endsWith(String) decl_stmt java.io.FileSystem = call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() call MiniDFSCluster.getFileSystem() decl_stmt java.nio.file.Path = new decl_stmt java.nio.file.Path = new ! call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() decl_stmt java.lang.String = new new decl_stmt java.nio.file.Path = new + ! call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.mkdirs() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() call org.apache.solr.core.HdfsDirectoryFactory.cleanupOldIndexDirectories(String,String) call org.apache.solr.core.HdfsDirectoryFactory.cleanupOldIndexDirectories(String,String) call org.apache.solr.core.HdfsDirectoryFactory.cleanupOldIndexDirectories(String,String) call org.apache.solr.core.HdfsDirectoryFactory.cleanupOldIndexDirectories(String,String) call org.apache.solr.core.HdfsDirectoryFactory.cleanupOldIndexDirectories(String,String) call decl org.toString() call decl org.toString() call decl org.toString() call decl org.toString() call decl org.toString() call decl apache.toString() call decl apache.toString() call decl apache.toString() call decl apache.toString() call decl apache.toString() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() ! call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() call FileSystem.isDirectory() decl NamedList SolrInfoMBean decl Iterator HdfsDirectoryFactory Configuration decl Map long String Directory public public throws decl_stmt Configuration = call Configuration.set() call Configuration.set() call Configuration.set() call Configuration.set() call Configuration.set() decl_stmt org.apache.solr.core.HdfsDirectoryFactory = new decl_stmt java.util.Map < = new < call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() + call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call decl Map.put() call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) call org.apache.solr.core.HdfsDirectoryFactory.init(NamedList) new <> decl_stmt java.util.Iterator < = call org.apache.solr.core.HdfsDirectoryFactory.offerMBeans() call org.apache.solr.core.HdfsDirectoryFactory.offerMBeans() call org.apache.solr.core.HdfsDirectoryFactory.offerMBeans() call org.apache.solr.core.HdfsDirectoryFactory.offerMBeans() call org.apache.solr.core.HdfsDirectoryFactory.offerMBeans() call decl Iterator.next() call decl Iterator.next() call decl Iterator.next() call decl Iterator.next() call decl Iterator.next() decl_stmt org.apache.solr.core.SolrInfoMBean = call decl Iterator.next() call decl Iterator.next() call decl Iterator.next() call decl Iterator.next() call decl Iterator.next() + call org.apache.solr.core.SolrInfoMBean.getName() call org.apache.solr.core.SolrInfoMBean.getName() call org.apache.solr.core.SolrInfoMBean.getName() call org.apache.solr.core.SolrInfoMBean.getName() call org.apache.solr.core.SolrInfoMBean.getName() call org.apache.solr.core.SolrInfoMBean.getName() call org.apache.solr.core.SolrInfoMBean.getName() call org.apache.solr.core.SolrInfoMBean.getName() call org.apache.solr.core.SolrInfoMBean.getName() call org.apache.solr.core.SolrInfoMBean.getName() decl_stmt org.apache.solr.common.util.NamedList < = call org.apache.solr.core.SolrInfoMBean.getStatistics() call org.apache.solr.core.SolrInfoMBean.getStatistics() call org.apache.solr.core.SolrInfoMBean.getStatistics() call org.apache.solr.core.SolrInfoMBean.getStatistics() call org.apache.solr.core.SolrInfoMBean.getStatistics() + call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() + call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() decl_stmt java.lang.String = + decl_stmt org.apache.lucene.store.Directory = call org.apache.solr.core.HdfsDirectoryFactory.create(String,LockFactory,DirContext) call org.apache.solr.core.HdfsDirectoryFactory.create(String,LockFactory,DirContext) call org.apache.solr.core.HdfsDirectoryFactory.create(String,LockFactory,DirContext) call org.apache.solr.core.HdfsDirectoryFactory.create(String,LockFactory,DirContext) call org.apache.solr.core.HdfsDirectoryFactory.create(String,LockFactory,DirContext) try = call Directory.createOutput() call Directory.createOutput() call Directory.createOutput() call Directory.createOutput() call Directory.createOutput() decl_stmt long final final = / call org.apache.solr.core.HdfsDirectoryFactory.setHost(String) call org.apache.solr.core.HdfsDirectoryFactory.setHost(String) call org.apache.solr.core.HdfsDirectoryFactory.setHost(String) call org.apache.solr.core.HdfsDirectoryFactory.setHost(String) call org.apache.solr.core.HdfsDirectoryFactory.setHost(String) = call org.apache.solr.core.SolrInfoMBean.getStatistics() call org.apache.solr.core.SolrInfoMBean.getStatistics() call org.apache.solr.core.SolrInfoMBean.getStatistics() call org.apache.solr.core.SolrInfoMBean.getStatistics() call org.apache.solr.core.SolrInfoMBean.getStatistics() + call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() + call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() + call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call org.apache.solr.core.HdfsDirectoryFactory.setHost(String) call org.apache.solr.core.HdfsDirectoryFactory.setHost(String) call org.apache.solr.core.HdfsDirectoryFactory.setHost(String) call org.apache.solr.core.HdfsDirectoryFactory.setHost(String) call org.apache.solr.core.HdfsDirectoryFactory.setHost(String) = call org.apache.solr.core.SolrInfoMBean.getStatistics() call org.apache.solr.core.SolrInfoMBean.getStatistics() call org.apache.solr.core.SolrInfoMBean.getStatistics() call org.apache.solr.core.SolrInfoMBean.getStatistics() call org.apache.solr.core.SolrInfoMBean.getStatistics() + call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call decl NamedList.get() call org.apache.solr.core.HdfsDirectoryFactory.close() call org.apache.solr.core.HdfsDirectoryFactory.close() call org.apache.solr.core.HdfsDirectoryFactory.close() call org.apache.solr.core.HdfsDirectoryFactory.close() call org.apache.solr.core.HdfsDirectoryFactory.close()