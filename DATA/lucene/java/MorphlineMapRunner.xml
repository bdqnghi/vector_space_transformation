org.apache.solr.hadoop.morphline java.io.BufferedInputStream import java.io.ByteArrayInputStream import java.io.File import java.io.IOException import java.io.InputStream import java.lang.invoke.MethodHandles import java.util.HashMap import java.util.Map import java.util.TreeMap import org.apache.hadoop.conf.Configuration import org.apache.hadoop.fs.FileStatus import org.apache.hadoop.mapreduce.Mapper.Context import org.apache.solr.client.solrj.SolrServerException import org.apache.solr.hadoop.HdfsFileFieldNames import org.apache.solr.hadoop.PathParts import org.apache.solr.hadoop.Utils import org.apache.solr.morphlines.solr.DocumentLoader import org.apache.solr.morphlines.solr.SolrLocator import org.apache.solr.morphlines.solr.SolrMorphlineContext import org.apache.solr.schema.IndexSchema import org.slf4j.Logger import org.slf4j.LoggerFactory import org.kitesdk.morphline.api.Command import org.kitesdk.morphline.api.MorphlineCompilationException import org.kitesdk.morphline.api.MorphlineContext import org.kitesdk.morphline.api.Record import org.kitesdk.morphline.base.Compiler import org.kitesdk.morphline.base.FaultTolerance import org.kitesdk.morphline.base.Fields import org.kitesdk.morphline.base.Metrics import org.kitesdk.morphline.base.Notifications import com.codahale.metrics.MetricRegistry import com.codahale.metrics.Timer import com.google.common.annotations.Beta import com.google.common.base.Joiner import com.typesafe.config.Config import com.typesafe.config.ConfigFactory import class annotation org.apache.solr.hadoop.morphline.MorphlineMapRunner Timer Logger String boolean Command String MorphlineContext String decl Map String String String IndexSchema return return Record PathParts decl Context decl Timer InputStream public public throws call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) call java.util.logging.Logger.info(String) decl_stmt java.io.InputStream = decl_stmt Record = decl_stmt sun.tools.tree.Context = call org.apache.solr.util.stats.Timer.time() call org.apache.solr.util.stats.Timer.time() call org.apache.solr.util.stats.Timer.time() call org.apache.solr.util.stats.Timer.time() call org.apache.solr.util.stats.Timer.time() try decl_stmt org.apache.solr.hadoop.PathParts = new = if == return for < : call decl Map.entrySet() call decl Map.entrySet() call decl Map.entrySet() call decl Map.entrySet() call decl Map.entrySet() call Record.replaceValues() call Record.replaceValues() call Record.replaceValues() call Record.replaceValues() call Record.replaceValues() decl_stmt long = call decl Context.getFileStatus() call decl Context.getFileStatus() call decl Context.getFileStatus() call decl Context.getFileStatus() call decl Context.getFileStatus() if = new new else = new call decl Context.getFileSystem() call decl Context.getFileSystem() call decl Context.getFileSystem() call decl Context.getFileSystem() call decl Context.getFileSystem() call decl Context.getUploadPath() call decl Context.getUploadPath() call decl Context.getUploadPath() call decl Context.getUploadPath() call decl Context.getUploadPath() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() if ! call Command.process() call Command.process() call Command.process() call Command.process() call Command.process() call Logger.warn() call Logger.warn() call Logger.warn() call Logger.warn() call Logger.warn() if != catch call Logger.error() call Logger.error() call Logger.error() call Logger.error() call Logger.error() + if != + call MorphlineContext.getExceptionHandler() call MorphlineContext.getExceptionHandler() call MorphlineContext.getExceptionHandler() call MorphlineContext.getExceptionHandler() call MorphlineContext.getExceptionHandler() finally call decl Timer.stop() call decl Timer.stop() call decl Timer.stop() call decl Timer.stop() call decl Timer.stop() if != call java.io.InputStream.close() call java.io.InputStream.close() call java.io.InputStream.close() call java.io.InputStream.close() call java.io.InputStream.close() Record FileStatus protected protected decl_stmt FileStatus try = catch = if == call Logger.warn() call Logger.warn() call Logger.warn() call Logger.warn() call Logger.warn() return decl_stmt Record = new call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call FileStatus.getModificationTime() call FileStatus.getModificationTime() call FileStatus.getModificationTime() call FileStatus.getModificationTime() call FileStatus.getModificationTime() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call FileStatus.getLen() call FileStatus.getLen() call FileStatus.getLen() call FileStatus.getLen() call FileStatus.getLen() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call FileStatus.getOwner() call FileStatus.getOwner() call FileStatus.getOwner() call FileStatus.getOwner() call FileStatus.getOwner() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call FileStatus.getGroup() call FileStatus.getGroup() call FileStatus.getGroup() call FileStatus.getGroup() call FileStatus.getGroup() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call FileStatus.getPermission() call FileStatus.getPermission() call FileStatus.getPermission() call FileStatus.getPermission() call FileStatus.getPermission() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call FileStatus.getPermission() call FileStatus.getPermission() call FileStatus.getPermission() call FileStatus.getPermission() call FileStatus.getPermission() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call FileStatus.getPermission() call FileStatus.getPermission() call FileStatus.getPermission() call FileStatus.getPermission() call FileStatus.getPermission() call Record.put() call Record.put() call Record.put() call Record.put() call Record.put() call FileStatus.getPermission() call FileStatus.getPermission() call FileStatus.getPermission() call FileStatus.getPermission() call FileStatus.getPermission() return public public