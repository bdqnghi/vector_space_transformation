org.apache.lucene.facet.taxonomy java.io.IOException import java.util.ArrayList import java.util.HashSet import java.util.List import java.util.Set import java.util.concurrent.atomic.AtomicBoolean import org.apache.lucene.analysis.MockAnalyzer import org.apache.lucene.document.Document import org.apache.lucene.facet.FacetField import org.apache.lucene.facet.FacetResult import org.apache.lucene.facet.FacetTestCase import org.apache.lucene.facet.Facets import org.apache.lucene.facet.FacetsCollector import org.apache.lucene.facet.FacetsConfig import org.apache.lucene.facet.taxonomy.SearcherTaxonomyManager.SearcherAndTaxonomy import org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter import org.apache.lucene.index.IndexWriter import org.apache.lucene.index.IndexWriterConfig import org.apache.lucene.index.TieredMergePolicy import org.apache.lucene.search.MatchAllDocsQuery import org.apache.lucene.search.ReferenceManager import org.apache.lucene.store.Directory import org.apache.lucene.util.IOUtils import org.apache.lucene.util.TestUtil import class org.apache.lucene.facet.taxonomy.TestSearcherTaxonomyManager super super extends decl Set String Document int decl List public public try decl_stmt java.util.Set < = new <> decl_stmt java.util.List < = new <> while decl_stmt org.apache.lucene.document.Document = new decl_stmt int = for = < ++ decl_stmt java.lang.String if ! call decl List.isEmpty() call decl List.isEmpty() call decl List.isEmpty() call decl List.isEmpty() call decl List.isEmpty() && != = call decl List.get() call decl List.get() call decl List.get() call decl List.get() call decl List.get() call decl List.size() call decl List.size() call decl List.size() call decl List.size() call decl List.size() else = while = if call java.lang.String.length() call java.lang.String.length() call java.lang.String.length() call java.lang.String.length() call java.lang.String.length() != && ! call decl Set.contains() call decl Set.contains() call decl Set.contains() call decl Set.contains() call decl Set.contains() call decl Set.add() call decl Set.add() call decl Set.add() call decl Set.add() call decl Set.add() call decl List.add() call decl List.add() call decl List.add() call decl List.add() call decl List.add() break call org.apache.lucene.document.Document.add(IndexableField) call org.apache.lucene.document.Document.add(IndexableField) call org.apache.lucene.document.Document.add(IndexableField) call org.apache.lucene.document.Document.add(IndexableField) call org.apache.lucene.document.Document.add(IndexableField) new try if != && < catch throw new if + + + if >= break finally TieredMergePolicy IndexWriterConfig DirectoryTaxonomyWriter Facets AtomicBoolean Thread FacetsCollector SearcherTaxonomyManager SearcherAndTaxonomy FacetResult IndexWriter Directory int FacetsConfig Thread Directory public public throws decl_stmt org.apache.lucene.store.Directory = decl_stmt org.apache.lucene.store.Directory = decl_stmt org.apache.lucene.index.IndexWriterConfig = new call org.apache.lucene.index.IndexWriterConfig.setMaxBufferedDocs(int) call org.apache.lucene.index.IndexWriterConfig.setMaxBufferedDocs(int) call org.apache.lucene.index.IndexWriterConfig.setMaxBufferedDocs(int) call org.apache.lucene.index.IndexWriterConfig.setMaxBufferedDocs(int) call org.apache.lucene.index.IndexWriterConfig.setMaxBufferedDocs(int) call org.apache.lucene.index.IndexWriterConfig.getMaxBufferedDocs() call org.apache.lucene.index.IndexWriterConfig.getMaxBufferedDocs() call org.apache.lucene.index.IndexWriterConfig.getMaxBufferedDocs() call org.apache.lucene.index.IndexWriterConfig.getMaxBufferedDocs() call org.apache.lucene.index.IndexWriterConfig.getMaxBufferedDocs() decl_stmt org.apache.lucene.index.TieredMergePolicy = new call org.apache.lucene.index.TieredMergePolicy.setFloorSegmentMB(double) call org.apache.lucene.index.TieredMergePolicy.setFloorSegmentMB(double) call org.apache.lucene.index.TieredMergePolicy.setFloorSegmentMB(double) call org.apache.lucene.index.TieredMergePolicy.setFloorSegmentMB(double) call org.apache.lucene.index.TieredMergePolicy.setFloorSegmentMB(double) call org.apache.lucene.index.IndexWriterConfig.setMergePolicy(MergePolicy) call org.apache.lucene.index.IndexWriterConfig.setMergePolicy(MergePolicy) call org.apache.lucene.index.IndexWriterConfig.setMergePolicy(MergePolicy) call org.apache.lucene.index.IndexWriterConfig.setMergePolicy(MergePolicy) call org.apache.lucene.index.IndexWriterConfig.setMergePolicy(MergePolicy) decl_stmt org.apache.lucene.index.IndexWriter final final = new decl_stmt org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter final final = new decl_stmt org.apache.lucene.facet.FacetsConfig final final = new call org.apache.lucene.facet.FacetsConfig.setMultiValued(String,boolean) call org.apache.lucene.facet.FacetsConfig.setMultiValued(String,boolean) call org.apache.lucene.facet.FacetsConfig.setMultiValued(String,boolean) call org.apache.lucene.facet.FacetsConfig.setMultiValued(String,boolean) call org.apache.lucene.facet.FacetsConfig.setMultiValued(String,boolean) decl_stmt java.util.concurrent.atomic.AtomicBoolean final final = new decl_stmt int final final = : decl_stmt java.lang.Thread = new decl_stmt org.apache.lucene.facet.taxonomy.SearcherTaxonomyManager final final = new decl_stmt java.lang.Thread = new public public while ! call java.util.concurrent.atomic.AtomicBoolean.get() call java.util.concurrent.atomic.AtomicBoolean.get() call java.util.concurrent.atomic.AtomicBoolean.get() call java.util.concurrent.atomic.AtomicBoolean.get() call java.util.concurrent.atomic.AtomicBoolean.get() try if call SearcherTaxonomyManager.maybeRefresh() call SearcherTaxonomyManager.maybeRefresh() call SearcherTaxonomyManager.maybeRefresh() call SearcherTaxonomyManager.maybeRefresh() call SearcherTaxonomyManager.maybeRefresh() if catch throw new call java.lang.Thread.setName(String) call java.lang.Thread.setName(String) call java.lang.Thread.setName(String) call java.lang.Thread.setName(String) call java.lang.Thread.setName(String) call java.lang.Thread.start() call java.lang.Thread.start() call java.lang.Thread.start() call java.lang.Thread.start() call java.lang.Thread.start() call java.lang.Thread.setName(String) call java.lang.Thread.setName(String) call java.lang.Thread.setName(String) call java.lang.Thread.setName(String) call java.lang.Thread.setName(String) call java.lang.Thread.start() call java.lang.Thread.start() call java.lang.Thread.start() call java.lang.Thread.start() call java.lang.Thread.start() try while ! call java.util.concurrent.atomic.AtomicBoolean.get() call java.util.concurrent.atomic.AtomicBoolean.get() call java.util.concurrent.atomic.AtomicBoolean.get() call java.util.concurrent.atomic.AtomicBoolean.get() call java.util.concurrent.atomic.AtomicBoolean.get() decl_stmt SearcherAndTaxonomy = call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() try decl_stmt org.apache.lucene.facet.FacetsCollector = new call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() new decl_stmt Facets = decl_stmt org.apache.lucene.facet.FacetResult = call Facets.getTopChildren() call Facets.getTopChildren() call Facets.getTopChildren() call Facets.getTopChildren() call Facets.getTopChildren() if call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() > > > finally call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() finally call java.lang.Thread.join(long,int) call java.lang.Thread.join(long,int) call java.lang.Thread.join(long,int) call java.lang.Thread.join(long,int) call java.lang.Thread.join(long,int) call java.lang.Thread.join(long,int) call java.lang.Thread.join(long,int) call java.lang.Thread.join(long,int) call java.lang.Thread.join(long,int) call java.lang.Thread.join(long,int) if call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() public public while ! try if if catch throw new Directory Facets AtomicBoolean Thread SearcherTaxonomyManager SearcherAndTaxonomy FacetResult IndexWriter DirectoryTaxonomyWriter Directory int FacetsConfig FacetsCollector public public throws decl_stmt org.apache.lucene.store.Directory = decl_stmt org.apache.lucene.store.Directory = decl_stmt org.apache.lucene.index.IndexWriter final final = new new decl_stmt org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter final final = new call org.apache.lucene.index.IndexWriter.commit(SegmentInfos) call org.apache.lucene.index.IndexWriter.commit(SegmentInfos) call org.apache.lucene.index.IndexWriter.commit(SegmentInfos) call org.apache.lucene.index.IndexWriter.commit(SegmentInfos) call org.apache.lucene.index.IndexWriter.commit(SegmentInfos) call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.commit() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.commit() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.commit() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.commit() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.commit() decl_stmt org.apache.lucene.facet.taxonomy.SearcherTaxonomyManager final final = new decl_stmt org.apache.lucene.facet.FacetsConfig final final = new call org.apache.lucene.facet.FacetsConfig.setMultiValued(String,boolean) call org.apache.lucene.facet.FacetsConfig.setMultiValued(String,boolean) call org.apache.lucene.facet.FacetsConfig.setMultiValued(String,boolean) call org.apache.lucene.facet.FacetsConfig.setMultiValued(String,boolean) call org.apache.lucene.facet.FacetsConfig.setMultiValued(String,boolean) decl_stmt java.util.concurrent.atomic.AtomicBoolean final final = new decl_stmt int final final = : decl_stmt java.lang.Thread = new call java.lang.Thread.start() call java.lang.Thread.start() call java.lang.Thread.start() call java.lang.Thread.start() call java.lang.Thread.start() try while ! call java.util.concurrent.atomic.AtomicBoolean.get() call java.util.concurrent.atomic.AtomicBoolean.get() call java.util.concurrent.atomic.AtomicBoolean.get() call java.util.concurrent.atomic.AtomicBoolean.get() call java.util.concurrent.atomic.AtomicBoolean.get() decl_stmt SearcherAndTaxonomy = call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() try decl_stmt org.apache.lucene.facet.FacetsCollector = new call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() new decl_stmt Facets = decl_stmt org.apache.lucene.facet.FacetResult = call Facets.getTopChildren() call Facets.getTopChildren() call Facets.getTopChildren() call Facets.getTopChildren() call Facets.getTopChildren() if call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() call SearcherAndTaxonomy.searcher() > > > finally call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() finally call java.lang.Thread.join(long,int) call java.lang.Thread.join(long,int) call java.lang.Thread.join(long,int) call java.lang.Thread.join(long,int) call java.lang.Thread.join(long,int) if call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() Directory DirectoryTaxonomyWriter DirectoryTaxonomyWriter SearcherTaxonomyManager IndexWriter Directory Directory public public throws decl_stmt org.apache.lucene.store.Directory = decl_stmt org.apache.lucene.store.Directory = decl_stmt org.apache.lucene.index.IndexWriter = new new decl_stmt org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter = new decl_stmt org.apache.lucene.store.Directory = decl_stmt org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter = new call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.close() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.close() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.close() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.close() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.close() decl_stmt org.apache.lucene.facet.taxonomy.SearcherTaxonomyManager = new call org.apache.lucene.index.IndexWriter.addDocument(Iterable) call org.apache.lucene.index.IndexWriter.addDocument(Iterable) call org.apache.lucene.index.IndexWriter.addDocument(Iterable) call org.apache.lucene.index.IndexWriter.addDocument(Iterable) call org.apache.lucene.index.IndexWriter.addDocument(Iterable) new call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.replaceTaxonomy(Directory) call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.replaceTaxonomy(Directory) call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.replaceTaxonomy(Directory) call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.replaceTaxonomy(Directory) call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.replaceTaxonomy(Directory) call Directory.close() call Directory.close() call Directory.close() call Directory.close() call Directory.close() call SearcherTaxonomyManager.maybeRefresh() call SearcherTaxonomyManager.maybeRefresh() call SearcherTaxonomyManager.maybeRefresh() call SearcherTaxonomyManager.maybeRefresh() call SearcherTaxonomyManager.maybeRefresh() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() Directory Directory DirectoryTaxonomyWriter SearcherTaxonomyManager SearcherAndTaxonomy IndexWriter DirectoryTaxonomyWriter Directory public public throws decl_stmt org.apache.lucene.store.Directory = decl_stmt org.apache.lucene.store.Directory = decl_stmt org.apache.lucene.index.IndexWriter = new new decl_stmt org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter = new call org.apache.lucene.index.IndexWriter.commit(SegmentInfos) call org.apache.lucene.index.IndexWriter.commit(SegmentInfos) call org.apache.lucene.index.IndexWriter.commit(SegmentInfos) call org.apache.lucene.index.IndexWriter.commit(SegmentInfos) call org.apache.lucene.index.IndexWriter.commit(SegmentInfos) call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.commit() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.commit() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.commit() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.commit() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.commit() decl_stmt org.apache.lucene.store.Directory = decl_stmt org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter = new call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.addCategory(FacetLabel) call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.addCategory(FacetLabel) call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.addCategory(FacetLabel) call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.addCategory(FacetLabel) call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.addCategory(FacetLabel) new call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.close() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.close() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.close() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.close() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.close() decl_stmt org.apache.lucene.facet.taxonomy.SearcherTaxonomyManager = new decl_stmt SearcherAndTaxonomy = call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() try call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() finally call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() call org.apache.lucene.index.IndexWriter.addDocument(Iterable) call org.apache.lucene.index.IndexWriter.addDocument(Iterable) call org.apache.lucene.index.IndexWriter.addDocument(Iterable) call org.apache.lucene.index.IndexWriter.addDocument(Iterable) call org.apache.lucene.index.IndexWriter.addDocument(Iterable) new call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.replaceTaxonomy(Directory) call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.replaceTaxonomy(Directory) call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.replaceTaxonomy(Directory) call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.replaceTaxonomy(Directory) call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.replaceTaxonomy(Directory) call Directory.close() call Directory.close() call Directory.close() call Directory.close() call Directory.close() call org.apache.lucene.index.IndexWriter.commit(SegmentInfos) call org.apache.lucene.index.IndexWriter.commit(SegmentInfos) call org.apache.lucene.index.IndexWriter.commit(SegmentInfos) call org.apache.lucene.index.IndexWriter.commit(SegmentInfos) call org.apache.lucene.index.IndexWriter.commit(SegmentInfos) call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.commit() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.commit() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.commit() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.commit() call org.apache.lucene.facet.taxonomy.directory.DirectoryTaxonomyWriter.commit() call SearcherTaxonomyManager.maybeRefresh() call SearcherTaxonomyManager.maybeRefresh() call SearcherTaxonomyManager.maybeRefresh() call SearcherTaxonomyManager.maybeRefresh() call SearcherTaxonomyManager.maybeRefresh() = call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() call SearcherTaxonomyManager.acquire() try call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() call SearcherAndTaxonomy.taxonomyReader() finally call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() call SearcherTaxonomyManager.release() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close() call org.apache.lucene.index.IndexWriter.close()