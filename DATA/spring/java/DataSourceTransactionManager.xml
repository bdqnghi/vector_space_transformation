org.springframework.jdbc.datasource java.sql.Connection import java.sql.SQLException import javax.sql.DataSource import org.springframework.beans.factory.InitializingBean import org.springframework.transaction.CannotCreateTransactionException import org.springframework.transaction.TransactionDefinition import org.springframework.transaction.TransactionSystemException import org.springframework.transaction.support.AbstractPlatformTransactionManager import org.springframework.transaction.support.DefaultTransactionStatus import org.springframework.transaction.support.ResourceTransactionManager import org.springframework.transaction.support.TransactionSynchronizationManager import class annotation org.springframework.jdbc.datasource.DataSourceTransactionManager super super extends super implements DataSource public public if instanceof = else = public public return public public if == throw new public public return DataSourceTransactionObject ConnectionHolder protected protected decl_stmt DataSourceTransactionObject = new call DataSourceTransactionObject.setSavepointAllowed() call DataSourceTransactionObject.setSavepointAllowed() call DataSourceTransactionObject.setSavepointAllowed() call DataSourceTransactionObject.setSavepointAllowed() call DataSourceTransactionObject.setSavepointAllowed() decl_stmt org.springframework.jdbc.datasource.ConnectionHolder = call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() return DataSourceTransactionObject protected protected decl_stmt DataSourceTransactionObject = return call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() != && call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() Connection DataSourceTransactionObject Integer int Connection protected protected decl_stmt DataSourceTransactionObject = decl_stmt sun.rmi.transport.Connection = try if call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() == || call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() decl_stmt sun.rmi.transport.Connection = if + + call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() new call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() = call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() decl_stmt java.lang.Integer = call DataSourceTransactionObject.setPreviousIsolationLevel() call DataSourceTransactionObject.setPreviousIsolationLevel() call DataSourceTransactionObject.setPreviousIsolationLevel() call DataSourceTransactionObject.setPreviousIsolationLevel() call DataSourceTransactionObject.setPreviousIsolationLevel() if call sun.rmi.transport.Connection.getAutoCommit() call sun.rmi.transport.Connection.getAutoCommit() call sun.rmi.transport.Connection.getAutoCommit() call sun.rmi.transport.Connection.getAutoCommit() call sun.rmi.transport.Connection.getAutoCommit() call DataSourceTransactionObject.setMustRestoreAutoCommit() call DataSourceTransactionObject.setMustRestoreAutoCommit() call DataSourceTransactionObject.setMustRestoreAutoCommit() call DataSourceTransactionObject.setMustRestoreAutoCommit() call DataSourceTransactionObject.setMustRestoreAutoCommit() if + + call sun.rmi.transport.Connection.setAutoCommit(boolean) call sun.rmi.transport.Connection.setAutoCommit(boolean) call sun.rmi.transport.Connection.setAutoCommit(boolean) call sun.rmi.transport.Connection.setAutoCommit(boolean) call sun.rmi.transport.Connection.setAutoCommit(boolean) call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() decl_stmt int = if != call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() if call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() catch if call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() throw new DataSourceTransactionObject ConnectionHolder protected protected decl_stmt DataSourceTransactionObject = call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() call DataSourceTransactionObject.setConnectionHolder() decl_stmt org.springframework.jdbc.datasource.ConnectionHolder = return ConnectionHolder protected protected decl_stmt org.springframework.jdbc.datasource.ConnectionHolder = DataSourceTransactionObject Connection protected protected decl_stmt DataSourceTransactionObject = decl_stmt sun.rmi.transport.Connection = call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() if + + try call sun.rmi.transport.Connection.commit() call sun.rmi.transport.Connection.commit() call sun.rmi.transport.Connection.commit() call sun.rmi.transport.Connection.commit() call sun.rmi.transport.Connection.commit() catch throw new DataSourceTransactionObject Connection protected protected decl_stmt DataSourceTransactionObject = decl_stmt sun.rmi.transport.Connection = call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() if + + try call sun.rmi.transport.Connection.rollback() call sun.rmi.transport.Connection.rollback() call sun.rmi.transport.Connection.rollback() call sun.rmi.transport.Connection.rollback() call sun.rmi.transport.Connection.rollback() catch throw new DataSourceTransactionObject protected protected decl_stmt DataSourceTransactionObject = if + call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() + call DataSourceTransactionObject.setRollbackOnly() call DataSourceTransactionObject.setRollbackOnly() call DataSourceTransactionObject.setRollbackOnly() call DataSourceTransactionObject.setRollbackOnly() call DataSourceTransactionObject.setRollbackOnly() DataSourceTransactionObject Connection protected protected decl_stmt DataSourceTransactionObject = if call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() decl_stmt sun.rmi.transport.Connection = call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() try if call DataSourceTransactionObject.isMustRestoreAutoCommit() call DataSourceTransactionObject.isMustRestoreAutoCommit() call DataSourceTransactionObject.isMustRestoreAutoCommit() call DataSourceTransactionObject.isMustRestoreAutoCommit() call DataSourceTransactionObject.isMustRestoreAutoCommit() call sun.rmi.transport.Connection.setAutoCommit(boolean) call sun.rmi.transport.Connection.setAutoCommit(boolean) call sun.rmi.transport.Connection.setAutoCommit(boolean) call sun.rmi.transport.Connection.setAutoCommit(boolean) call sun.rmi.transport.Connection.setAutoCommit(boolean) call DataSourceTransactionObject.getPreviousIsolationLevel() call DataSourceTransactionObject.getPreviousIsolationLevel() call DataSourceTransactionObject.getPreviousIsolationLevel() call DataSourceTransactionObject.getPreviousIsolationLevel() call DataSourceTransactionObject.getPreviousIsolationLevel() catch if call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() call DataSourceTransactionObject.isNewConnectionHolder() if + + call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() call DataSourceTransactionObject.getConnectionHolder() public public = public public return public public = public public return public public public public return