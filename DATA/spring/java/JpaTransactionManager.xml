org.springframework.orm.jpa java.util.HashMap import java.util.Map import java.util.Properties import javax.persistence.EntityManager import javax.persistence.EntityManagerFactory import javax.persistence.EntityTransaction import javax.persistence.PersistenceException import javax.persistence.RollbackException import javax.sql.DataSource import org.springframework.beans.BeansException import org.springframework.beans.factory.BeanFactory import org.springframework.beans.factory.BeanFactoryAware import org.springframework.beans.factory.InitializingBean import org.springframework.beans.factory.ListableBeanFactory import org.springframework.dao.DataAccessException import org.springframework.dao.support.DataAccessUtils import org.springframework.jdbc.datasource.ConnectionHandle import org.springframework.jdbc.datasource.ConnectionHolder import org.springframework.jdbc.datasource.JdbcTransactionObjectSupport import org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy import org.springframework.transaction.CannotCreateTransactionException import org.springframework.transaction.IllegalTransactionStateException import org.springframework.transaction.NestedTransactionNotSupportedException import org.springframework.transaction.SavepointManager import org.springframework.transaction.TransactionDefinition import org.springframework.transaction.TransactionException import org.springframework.transaction.TransactionSystemException import org.springframework.transaction.support.AbstractPlatformTransactionManager import org.springframework.transaction.support.DefaultTransactionStatus import org.springframework.transaction.support.DelegatingTransactionDefinition import org.springframework.transaction.support.ResourceTransactionManager import org.springframework.transaction.support.TransactionSynchronizationManager import org.springframework.util.CollectionUtils import class annotation org.springframework.orm.jpa.JpaTransactionManager super super extends super implements EntityManagerFactory String decl Map JpaDialect DataSource public public = public public return public public = public public return public public public public < if != public < public < return public public if instanceof = else = public public return public public = != : new public public return ListableBeanFactory public public throws if == if ! instanceof throw new + + decl_stmt org.springframework.beans.factory.ListableBeanFactory = JpaDialect EntityManagerFactoryInfo DataSource public public if == throw new if instanceof decl_stmt org.springframework.orm.jpa.EntityManagerFactoryInfo = decl_stmt javax.sql.DataSource = call org.springframework.orm.jpa.EntityManagerFactoryInfo.getDataSource() call org.springframework.orm.jpa.EntityManagerFactoryInfo.getDataSource() call org.springframework.orm.jpa.EntityManagerFactoryInfo.getDataSource() call org.springframework.orm.jpa.EntityManagerFactoryInfo.getDataSource() call org.springframework.orm.jpa.EntityManagerFactoryInfo.getDataSource() if != decl_stmt org.springframework.orm.jpa.JpaDialect = call org.springframework.orm.jpa.EntityManagerFactoryInfo.getJpaDialect() call org.springframework.orm.jpa.EntityManagerFactoryInfo.getJpaDialect() call org.springframework.orm.jpa.EntityManagerFactoryInfo.getJpaDialect() call org.springframework.orm.jpa.EntityManagerFactoryInfo.getJpaDialect() call org.springframework.orm.jpa.EntityManagerFactoryInfo.getJpaDialect() if != public public return JpaTransactionObject EntityManagerHolder ConnectionHolder protected protected decl_stmt JpaTransactionObject = new call JpaTransactionObject.setSavepointAllowed() call JpaTransactionObject.setSavepointAllowed() call JpaTransactionObject.setSavepointAllowed() call JpaTransactionObject.setSavepointAllowed() call JpaTransactionObject.setSavepointAllowed() decl_stmt org.springframework.orm.jpa.EntityManagerHolder = if != if + call org.springframework.orm.jpa.EntityManagerHolder.getEntityManager() call org.springframework.orm.jpa.EntityManagerHolder.getEntityManager() call org.springframework.orm.jpa.EntityManagerHolder.getEntityManager() call org.springframework.orm.jpa.EntityManagerHolder.getEntityManager() call org.springframework.orm.jpa.EntityManagerHolder.getEntityManager() + call JpaTransactionObject.setEntityManagerHolder() call JpaTransactionObject.setEntityManagerHolder() call JpaTransactionObject.setEntityManagerHolder() call JpaTransactionObject.setEntityManagerHolder() call JpaTransactionObject.setEntityManagerHolder() if != decl_stmt org.springframework.jdbc.datasource.ConnectionHolder = call JpaTransactionObject.setConnectionHolder() call JpaTransactionObject.setConnectionHolder() call JpaTransactionObject.setConnectionHolder() call JpaTransactionObject.setConnectionHolder() call JpaTransactionObject.setConnectionHolder() return protected protected return EntityManager EntityManager ConnectionHolder Object JpaTransactionObject ConnectionHandle int protected protected decl_stmt JpaTransactionObject = if call JpaTransactionObject.hasConnectionHolder() call JpaTransactionObject.hasConnectionHolder() call JpaTransactionObject.hasConnectionHolder() call JpaTransactionObject.hasConnectionHolder() call JpaTransactionObject.hasConnectionHolder() && ! call JpaTransactionObject.getConnectionHolder() call JpaTransactionObject.getConnectionHolder() call JpaTransactionObject.getConnectionHolder() call JpaTransactionObject.getConnectionHolder() call JpaTransactionObject.getConnectionHolder() throw new + + + try if call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() == || call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() decl_stmt EntityManager = if + + call JpaTransactionObject.setEntityManagerHolder() call JpaTransactionObject.setEntityManagerHolder() call JpaTransactionObject.setEntityManagerHolder() call JpaTransactionObject.setEntityManagerHolder() call JpaTransactionObject.setEntityManagerHolder() new decl_stmt EntityManager = call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() decl_stmt int final final = decl_stmt java.lang.Object = new public public return call JpaTransactionObject.setTransactionData() call JpaTransactionObject.setTransactionData() call JpaTransactionObject.setTransactionData() call JpaTransactionObject.setTransactionData() call JpaTransactionObject.setTransactionData() if != call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() if != decl_stmt org.springframework.jdbc.datasource.ConnectionHandle = if != decl_stmt org.springframework.jdbc.datasource.ConnectionHolder = new if != call ConnectionHolder.setTimeoutInSeconds() call ConnectionHolder.setTimeoutInSeconds() call ConnectionHolder.setTimeoutInSeconds() call ConnectionHolder.setTimeoutInSeconds() call ConnectionHolder.setTimeoutInSeconds() if + call org.springframework.jdbc.datasource.ConnectionHolder.getConnectionHandle() call org.springframework.jdbc.datasource.ConnectionHolder.getConnectionHandle() call org.springframework.jdbc.datasource.ConnectionHolder.getConnectionHandle() call org.springframework.jdbc.datasource.ConnectionHolder.getConnectionHandle() call org.springframework.jdbc.datasource.ConnectionHolder.getConnectionHandle() + call JpaTransactionObject.setConnectionHolder() call JpaTransactionObject.setConnectionHolder() call JpaTransactionObject.setConnectionHolder() call JpaTransactionObject.setConnectionHolder() call JpaTransactionObject.setConnectionHolder() else if + + + + + if call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() catch throw catch throw new public public return EntityManagerFactory decl Map protected protected decl_stmt EntityManagerFactory = if instanceof = decl_stmt java.util.Map < = return ! call EntityManagerFactory.createEntityManager() call EntityManagerFactory.createEntityManager() call EntityManagerFactory.createEntityManager() call EntityManagerFactory.createEntityManager() call EntityManagerFactory.createEntityManager() : call EntityManagerFactory.createEntityManager() call EntityManagerFactory.createEntityManager() call EntityManagerFactory.createEntityManager() call EntityManagerFactory.createEntityManager() call EntityManagerFactory.createEntityManager() EntityManager protected protected if decl_stmt EntityManager = try if call EntityManager.getTransaction() call EntityManager.getTransaction() call EntityManager.getTransaction() call EntityManager.getTransaction() call EntityManager.getTransaction() call EntityManager.getTransaction() call EntityManager.getTransaction() call EntityManager.getTransaction() call EntityManager.getTransaction() call EntityManager.getTransaction() catch finally JpaTransactionObject ConnectionHolder EntityManagerHolder protected protected decl_stmt JpaTransactionObject = call JpaTransactionObject.setEntityManagerHolder() call JpaTransactionObject.setEntityManagerHolder() call JpaTransactionObject.setEntityManagerHolder() call JpaTransactionObject.setEntityManagerHolder() call JpaTransactionObject.setEntityManagerHolder() decl_stmt org.springframework.orm.jpa.EntityManagerHolder = call JpaTransactionObject.setConnectionHolder() call JpaTransactionObject.setConnectionHolder() call JpaTransactionObject.setConnectionHolder() call JpaTransactionObject.setConnectionHolder() call JpaTransactionObject.setConnectionHolder() decl_stmt org.springframework.jdbc.datasource.ConnectionHolder = if != && = return new SuspendedResourcesHolder protected protected decl_stmt SuspendedResourcesHolder = call SuspendedResourcesHolder.getEntityManagerHolder() call SuspendedResourcesHolder.getEntityManagerHolder() call SuspendedResourcesHolder.getEntityManagerHolder() call SuspendedResourcesHolder.getEntityManagerHolder() call SuspendedResourcesHolder.getEntityManagerHolder() if != && call SuspendedResourcesHolder.getConnectionHolder() call SuspendedResourcesHolder.getConnectionHolder() call SuspendedResourcesHolder.getConnectionHolder() call SuspendedResourcesHolder.getConnectionHolder() call SuspendedResourcesHolder.getConnectionHolder() != call SuspendedResourcesHolder.getConnectionHolder() call SuspendedResourcesHolder.getConnectionHolder() call SuspendedResourcesHolder.getConnectionHolder() call SuspendedResourcesHolder.getConnectionHolder() call SuspendedResourcesHolder.getConnectionHolder() protected protected return DataAccessException JpaTransactionObject EntityTransaction protected protected decl_stmt JpaTransactionObject = if + call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() + try decl_stmt EntityTransaction = call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call EntityTransaction.commit() call EntityTransaction.commit() call EntityTransaction.commit() call EntityTransaction.commit() call EntityTransaction.commit() catch if instanceof decl_stmt DataAccessException = if != throw throw new catch throw JpaTransactionObject EntityTransaction protected protected decl_stmt JpaTransactionObject = if + call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() + try decl_stmt EntityTransaction = call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() if call EntityTransaction.isActive() call EntityTransaction.isActive() call EntityTransaction.isActive() call EntityTransaction.isActive() call EntityTransaction.isActive() call EntityTransaction.rollback() call EntityTransaction.rollback() call EntityTransaction.rollback() call EntityTransaction.rollback() call EntityTransaction.rollback() catch throw new finally if ! call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() JpaTransactionObject protected protected decl_stmt JpaTransactionObject = if + call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() + call JpaTransactionObject.setRollbackOnly() call JpaTransactionObject.setRollbackOnly() call JpaTransactionObject.setRollbackOnly() call JpaTransactionObject.setRollbackOnly() call JpaTransactionObject.setRollbackOnly() EntityManager JpaTransactionObject protected protected decl_stmt JpaTransactionObject = if call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() if call JpaTransactionObject.hasConnectionHolder() call JpaTransactionObject.hasConnectionHolder() call JpaTransactionObject.hasConnectionHolder() call JpaTransactionObject.hasConnectionHolder() call JpaTransactionObject.hasConnectionHolder() try call JpaTransactionObject.getConnectionHolder() call JpaTransactionObject.getConnectionHolder() call JpaTransactionObject.getConnectionHolder() call JpaTransactionObject.getConnectionHolder() call JpaTransactionObject.getConnectionHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() catch call JpaTransactionObject.getTransactionData() call JpaTransactionObject.getTransactionData() call JpaTransactionObject.getTransactionData() call JpaTransactionObject.getTransactionData() call JpaTransactionObject.getTransactionData() if call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() call JpaTransactionObject.isNewEntityManagerHolder() decl_stmt EntityManager = call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() call JpaTransactionObject.getEntityManagerHolder() if + + else public public = = public public return public public return public public return != && public public = if instanceof public public return EntityTransaction public public decl_stmt EntityTransaction = if call EntityTransaction.isActive() call EntityTransaction.isActive() call EntityTransaction.isActive() call EntityTransaction.isActive() call EntityTransaction.isActive() call EntityTransaction.setRollbackOnly() call EntityTransaction.setRollbackOnly() call EntityTransaction.setRollbackOnly() call EntityTransaction.setRollbackOnly() call EntityTransaction.setRollbackOnly() if EntityTransaction public public decl_stmt EntityTransaction = return call EntityTransaction.getRollbackOnly() call EntityTransaction.getRollbackOnly() call EntityTransaction.getRollbackOnly() call EntityTransaction.getRollbackOnly() call EntityTransaction.getRollbackOnly() public public try catch throw public public throws return public public throws public public throws SavepointManager private private if ! throw new decl_stmt org.springframework.transaction.SavepointManager = if == throw new return private private return private private return