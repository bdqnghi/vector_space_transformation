Spring.Messaging.Nms.Connections Apache.NMS using NUnit.Framework using Rhino.Mocks using Spring.Messaging.Nms.Core using Spring.Transaction using Spring.Transaction.Support using class attribute Spring.Messaging.Nms.Connections.NmsTransactionManagerTests MockRepository public public = new NmsTransactionManager IConnectionFactory ITransactionStatus IConnection ISession NmsTemplate public public decl_stmt Spring.Messaging.Ems.Common.IConnectionFactory = < decl_stmt Spring.Messaging.Ems.Common.IConnection = < decl_stmt Spring.Messaging.Ems.Common.ISession = < using call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() decl_stmt Spring.Messaging.Nms.Connections.NmsTransactionManager = new decl_stmt Spring.Transaction.ITransactionStatus = call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() new decl_stmt Spring.Messaging.Nms.Core.NmsTemplate = new call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) new call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() NmsTransactionManager IConnectionFactory ITransactionStatus IConnection ISession NmsTemplate public public decl_stmt Spring.Messaging.Ems.Common.IConnectionFactory = < decl_stmt Spring.Messaging.Ems.Common.IConnection = < decl_stmt Spring.Messaging.Ems.Common.ISession = < call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() decl_stmt Spring.Messaging.Nms.Connections.NmsTransactionManager = new decl_stmt Spring.Transaction.ITransactionStatus = call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() new decl_stmt Spring.Messaging.Nms.Core.NmsTemplate = new call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) new call NmsTransactionManager.Rollback() call NmsTransactionManager.Rollback() call NmsTransactionManager.Rollback() call NmsTransactionManager.Rollback() call NmsTransactionManager.Rollback() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() NmsTransactionManager IConnectionFactory TransactionTemplate ITransactionStatus IConnection ISession NmsTemplate public public decl_stmt Spring.Messaging.Ems.Common.IConnectionFactory = < decl_stmt Spring.Messaging.Ems.Common.IConnection = < decl_stmt Spring.Messaging.Ems.Common.ISession = < using call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() decl_stmt Spring.Messaging.Nms.Connections.NmsTransactionManager = new decl_stmt Spring.Transaction.ITransactionStatus = call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() new decl_stmt Spring.Messaging.Nms.Core.NmsTemplate = new call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) new decl_stmt Spring.Transaction.Support.TransactionTemplate = new call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) new return call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() NmsTransactionManager IConnectionFactory TransactionTemplate ITransactionStatus IConnection ISession NmsTemplate public public decl_stmt Spring.Messaging.Ems.Common.IConnectionFactory = < decl_stmt Spring.Messaging.Ems.Common.IConnection = < decl_stmt Spring.Messaging.Ems.Common.ISession = < using call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() decl_stmt Spring.Messaging.Nms.Connections.NmsTransactionManager = new decl_stmt Spring.Transaction.ITransactionStatus = call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() new decl_stmt Spring.Messaging.Nms.Core.NmsTemplate = new call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) new decl_stmt Spring.Transaction.Support.TransactionTemplate = new call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) new return try call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() catch call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() NmsTransactionManager IConnectionFactory ISession TransactionTemplate ITransactionStatus IConnection ISession NmsTemplate public public decl_stmt Spring.Messaging.Ems.Common.IConnectionFactory = < decl_stmt Spring.Messaging.Ems.Common.IConnection = < decl_stmt Spring.Messaging.Ems.Common.ISession = < decl_stmt Spring.Messaging.Ems.Common.ISession = < call Spring.Messaging.Ems.Common.IConnectionFactory.CreateConnection() call Spring.Messaging.Ems.Common.IConnectionFactory.CreateConnection() call Spring.Messaging.Ems.Common.IConnectionFactory.CreateConnection() call Spring.Messaging.Ems.Common.IConnectionFactory.CreateConnection() call Spring.Messaging.Ems.Common.IConnectionFactory.CreateConnection() call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.ISession.Commit() call Spring.Messaging.Ems.Common.ISession.Commit() call Spring.Messaging.Ems.Common.ISession.Commit() call Spring.Messaging.Ems.Common.ISession.Commit() call Spring.Messaging.Ems.Common.ISession.Commit() call ISession.Close() call ISession.Close() call ISession.Close() call ISession.Close() call ISession.Close() call ISession.Close() call ISession.Close() call ISession.Close() call ISession.Close() call ISession.Close() call Spring.Messaging.Ems.Common.IConnection.Close() call Spring.Messaging.Ems.Common.IConnection.Close() call Spring.Messaging.Ems.Common.IConnection.Close() call Spring.Messaging.Ems.Common.IConnection.Close() call Spring.Messaging.Ems.Common.IConnection.Close() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() decl_stmt Spring.Messaging.Nms.Connections.NmsTransactionManager = new decl_stmt Spring.Transaction.ITransactionStatus = call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() new decl_stmt Spring.Messaging.Nms.Core.NmsTemplate = new call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) new decl_stmt Spring.Transaction.Support.TransactionTemplate = new = call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) new return call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) new call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() NmsTransactionManager IConnectionFactory ISession TransactionTemplate ITransactionStatus IConnection ISession NmsTemplate public public decl_stmt Spring.Messaging.Ems.Common.IConnectionFactory = < decl_stmt Spring.Messaging.Ems.Common.IConnection = < decl_stmt Spring.Messaging.Ems.Common.ISession = < decl_stmt Spring.Messaging.Ems.Common.ISession = < call Spring.Messaging.Ems.Common.IConnectionFactory.CreateConnection() call Spring.Messaging.Ems.Common.IConnectionFactory.CreateConnection() call Spring.Messaging.Ems.Common.IConnectionFactory.CreateConnection() call Spring.Messaging.Ems.Common.IConnectionFactory.CreateConnection() call Spring.Messaging.Ems.Common.IConnectionFactory.CreateConnection() call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.IConnection.CreateSession(bool,int) call Spring.Messaging.Ems.Common.ISession.Commit() call Spring.Messaging.Ems.Common.ISession.Commit() call Spring.Messaging.Ems.Common.ISession.Commit() call Spring.Messaging.Ems.Common.ISession.Commit() call Spring.Messaging.Ems.Common.ISession.Commit() call Spring.Messaging.Ems.Common.ISession.Commit() call Spring.Messaging.Ems.Common.ISession.Commit() call Spring.Messaging.Ems.Common.ISession.Commit() call Spring.Messaging.Ems.Common.ISession.Commit() call Spring.Messaging.Ems.Common.ISession.Commit() call ISession.Close() call ISession.Close() call ISession.Close() call ISession.Close() call ISession.Close() call ISession.Close() call ISession.Close() call ISession.Close() call ISession.Close() call ISession.Close() call Spring.Messaging.Ems.Common.IConnection.Close() call Spring.Messaging.Ems.Common.IConnection.Close() call Spring.Messaging.Ems.Common.IConnection.Close() call Spring.Messaging.Ems.Common.IConnection.Close() call Spring.Messaging.Ems.Common.IConnection.Close() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() decl_stmt Spring.Messaging.Nms.Connections.NmsTransactionManager = new decl_stmt Spring.Transaction.ITransactionStatus = call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() call NmsTransactionManager.GetTransaction() new decl_stmt Spring.Messaging.Nms.Core.NmsTemplate = new decl_stmt Spring.Transaction.Support.TransactionTemplate = new = call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) new return call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) call Spring.Messaging.Nms.Core.NmsTemplate.Execute(ISessionCallback) new call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call NmsTransactionManager.Commit() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() private static private static private static private static public public ==