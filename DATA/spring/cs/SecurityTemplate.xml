Spring System using System.Configuration using System.Data.SqlClient using System.Drawing.Printing using System.IO using System.Net using System.Runtime.InteropServices using System.Security using System.Security.Permissions using System.Security.Policy using System.Text using System.Threading using System.Web using System.Web.Configuration using class Spring.SecurityTemplate string string string string bool string PolicyLevel public static public static template= new new template , return return = string public public decl_stmt string = if != = PermissionSet public public decl_stmt System.Security.PermissionSet = = if == && throw new if ! call System.Security.PermissionSet.PermitOnly() call System.Security.PermissionSet.PermitOnly() call System.Security.PermissionSet.PermitOnly() call System.Security.PermissionSet.PermitOnly() call System.Security.PermissionSet.PermitOnly() else private private if != return call System.Security.Policy.PolicyLevel.GetNamedPermissionSet(string) call System.Security.Policy.PolicyLevel.GetNamedPermissionSet(string) call System.Security.Policy.PolicyLevel.GetNamedPermissionSet(string) call System.Security.Policy.PolicyLevel.GetNamedPermissionSet(string) call System.Security.Policy.PolicyLevel.GetNamedPermissionSet(string) return SecurityPolicySection string TrustSection string PolicyLevel public static public static decl_stmt System.Web.Configuration.TrustSection = decl_stmt System.Web.Configuration.SecurityPolicySection = if == || if ! return throw new if == return if == || == if ! return throw new decl_stmt string = decl_stmt string = decl_stmt System.Security.Policy.PolicyLevel = new return CodeGroup bool PermissionSet FirstMatchCodeGroup CodeGroup CodeGroup PolicyLevel bool public static public static decl_stmt bool = decl_stmt System.Security.Policy.PolicyLevel = out if decl_stmt System.Security.Policy.CodeGroup = decl_stmt bool = foreach in if is = break if ! && is decl_stmt System.Security.Policy.FirstMatchCodeGroup = if is && == decl_stmt System.Security.PermissionSet = new decl_stmt System.Security.Policy.CodeGroup = new new new decl_stmt System.Security.Policy.CodeGroup = new foreach in if is && is && && != call System.Security.Policy.CodeGroup.AddChild(CodeGroup) call System.Security.Policy.CodeGroup.AddChild(CodeGroup) call System.Security.Policy.CodeGroup.AddChild(CodeGroup) call System.Security.Policy.CodeGroup.AddChild(CodeGroup) call System.Security.Policy.CodeGroup.AddChild(CodeGroup) = call System.Security.Policy.CodeGroup.AddChild(CodeGroup) call System.Security.Policy.CodeGroup.AddChild(CodeGroup) call System.Security.Policy.CodeGroup.AddChild(CodeGroup) call System.Security.Policy.CodeGroup.AddChild(CodeGroup) call System.Security.Policy.CodeGroup.AddChild(CodeGroup) = return string string WebClient private static private static out out decl_stmt System.Net.WebClient = new decl_stmt string = call System.Net.WebClient.DownloadString(Uri) call System.Net.WebClient.DownloadString(Uri) call System.Net.WebClient.DownloadString(Uri) call System.Net.WebClient.DownloadString(Uri) call System.Net.WebClient.DownloadString(Uri) = = = call string.Replace() call string.Replace() call string.Replace() call string.Replace() call string.Replace() if == = = call string.Replace() call string.Replace() call string.Replace() call string.Replace() call string.Replace() if call string.IndexOf() call string.IndexOf() call string.IndexOf() call string.IndexOf() call string.IndexOf() != - decl_stmt string = if != = if == = = call string.Replace() call string.Replace() call string.Replace() call string.Replace() call string.Replace() = else = return string bool char char string private static private static decl_stmt bool = if > decl_stmt char = decl_stmt char = if == = else if == && == = if decl_stmt string = decl_stmt string = call string.Substring() call string.Substring() call string.Substring() call string.Substring() call string.Substring() call string.LastIndexOf() call string.LastIndexOf() call string.LastIndexOf() call string.LastIndexOf() call string.LastIndexOf() + return + return int int int StringBuilder private static private static decl_stmt int = decl_stmt System.Text.StringBuilder = new decl_stmt int = - decl_stmt int = ref if < throw new return call System.Text.StringBuilder.ToString(int,int) call System.Text.StringBuilder.ToString(int,int) call System.Text.StringBuilder.ToString(int,int) call System.Text.StringBuilder.ToString(int,int) call System.Text.StringBuilder.ToString(int,int) Uri private static private static decl_stmt System.Uri = new return call System.Uri.ToString() call System.Uri.ToString() call System.Uri.ToString() call System.Uri.ToString() call System.Uri.ToString() int internal static internal static if == return decl_stmt int = if > && - == = - return private static private static if != return return