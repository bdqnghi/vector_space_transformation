Spring.Data.Core System using System.Transactions using NUnit.Framework using Rhino.Mocks using Spring.Data.Support using Spring.Transaction using Spring.Transaction.Support using class attribute Spring.Data.Core.TxScopeTransactionManagerTests MockRepository public public = new ITransactionScopeAdapter TransactionTemplate TxScopeTransactionManager TransactionOptions public public decl_stmt Spring.Data.Support.ITransactionScopeAdapter = call MockRepository.CreateMock() call MockRepository.CreateMock() call MockRepository.CreateMock() call MockRepository.CreateMock() call MockRepository.CreateMock() typeof using call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() decl_stmt TransactionOptions = new = call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.Complete() call Spring.Data.Support.ITransactionScopeAdapter.Complete() call Spring.Data.Support.ITransactionScopeAdapter.Complete() call Spring.Data.Support.ITransactionScopeAdapter.Complete() call Spring.Data.Support.ITransactionScopeAdapter.Complete() call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() decl_stmt Spring.Data.Core.TxScopeTransactionManager = new = decl_stmt Spring.Transaction.Support.TransactionTemplate = new call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) return call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() ITransactionScopeAdapter TransactionTemplate TxScopeTransactionManager Exception TransactionOptions public public decl_stmt Spring.Data.Support.ITransactionScopeAdapter = call MockRepository.CreateMock() call MockRepository.CreateMock() call MockRepository.CreateMock() call MockRepository.CreateMock() call MockRepository.CreateMock() typeof using call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() decl_stmt TransactionOptions = new = call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() decl_stmt Spring.Data.Core.TxScopeTransactionManager = new = decl_stmt Spring.Transaction.Support.TransactionTemplate = new ! decl_stmt System.Exception = new try call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) if != throw return catch ! call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() ITransactionScopeAdapter TransactionTemplate TxScopeTransactionManager TransactionOptions public public decl_stmt Spring.Data.Support.ITransactionScopeAdapter = call MockRepository.CreateMock() call MockRepository.CreateMock() call MockRepository.CreateMock() call MockRepository.CreateMock() call MockRepository.CreateMock() typeof using call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() call MockRepository.Ordered() decl_stmt TransactionOptions = new = call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call Spring.Data.Support.ITransactionScopeAdapter.CreateTransactionScope(TransactionScopeOption,TransactionOptions,EnterpriseServicesInteropOption) call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call Spring.Data.Support.ITransactionScopeAdapter.Complete() call Spring.Data.Support.ITransactionScopeAdapter.Complete() call Spring.Data.Support.ITransactionScopeAdapter.Complete() call Spring.Data.Support.ITransactionScopeAdapter.Complete() call Spring.Data.Support.ITransactionScopeAdapter.Complete() call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call ITransactionScopeAdapter.Dispose() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() call MockRepository.ReplayAll() decl_stmt Spring.Data.Core.TxScopeTransactionManager = new = decl_stmt Spring.Transaction.Support.TransactionTemplate = new = call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) call Spring.Transaction.Support.TransactionTemplate.Execute(TransactionDelegate) return return call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll() call MockRepository.VerifyAll()